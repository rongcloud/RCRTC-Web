{"remainingRequest":"/Users/cuifengbo/work/RCRTC-Git/rcrtc-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/cuifengbo/work/RCRTC-Git/rcrtc-web/src/pages/live/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/cuifengbo/work/RCRTC-Git/rcrtc-web/src/pages/live/index.vue","mtime":1648191837448},{"path":"/Users/cuifengbo/work/RCRTC-Git/rcrtc-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/cuifengbo/work/RCRTC-Git/rcrtc-web/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/cuifengbo/work/RCRTC-Git/rcrtc-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/cuifengbo/work/RCRTC-Git/rcrtc-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBsaXZlVGl0bGUgZnJvbSAiLi4vLi4vY29tcG9uZW50cy9iYXNlVWkvbGl2ZVRpdGxlLnZ1ZSI7CmltcG9ydCBsaXZlQ3JlYXRlIGZyb20gIi4uLy4uL2NvbXBvbmVudHMvYmFzZVVpL2xpdmVDcmVhdGUudnVlIjsKaW1wb3J0IGxpdmVDaGF0IGZyb20gIi4uLy4uL2NvbXBvbmVudHMvYmFzZVVpL2xpdmVDaGF0LnZ1ZSI7CmltcG9ydCBib3R0b21CYXIgZnJvbSAiLi4vLi4vY29tcG9uZW50cy9iYXNlVWkvYm90dG9tQmFyLnZ1ZSI7CmltcG9ydCBnaWZ0UGFuZWwgZnJvbSAiLi4vLi4vY29tcG9uZW50cy9iYXNlVWkvZ2lmdFBhbmVsLnZ1ZSI7CmltcG9ydCB2aWRlb0JveCBmcm9tICIuLi8uLi9jb21wb25lbnRzL2Jhc2VVaS92aWRlb0JveC52dWUiOwppbXBvcnQgbGl2ZUF1ZGllbmNlIGZyb20gIi4uLy4uL2NvbXBvbmVudHMvYmFzZVVpL2xpdmVBdWRpZW5jZS52dWUiOwppbXBvcnQgbGl2ZVF1aXRTZWF0IGZyb20gIi4uLy4uL2NvbXBvbmVudHMvYmFzZVVpL2xpdmVRdWl0U2VhdC52dWUiOwppbXBvcnQgQ2FuY2VsRXZlblNlYXQgZnJvbSAiLi4vLi4vY29tcG9uZW50cy9yb29tL0NhbmNlbEV2ZW5TZWF0LnZ1ZSI7CgppbXBvcnQgcm9vbUJhY2sgZnJvbSAiLi4vLi4vY29tcG9uZW50cy9yb29tL1Jvb21CYWNrLnZ1ZSI7CmltcG9ydCBDb25uZXRXZWF0IGZyb20gIi4uLy4uL2NvbXBvbmVudHMvcm9vbS9Db25uZXRXZWF0LnZ1ZSI7CmltcG9ydCBSb29tRml0IGZyb20gIi4uLy4uL2NvbXBvbmVudHMvUm9vbUZpdC52dWUiOwppbXBvcnQgTm90aWNlIGZyb20gIi4uLy4uL2NvbXBvbmVudHMvcm9vbS9Ob3RpY2UudnVlIjsKaW1wb3J0IFVzZXJMaXN0IGZyb20gIi4uLy4uL2NvbXBvbmVudHMvcm9vbS9Vc2VyTGlzdC52dWUiOwppbXBvcnQgVXNlckNhcmQgZnJvbSAiLi4vLi4vY29tcG9uZW50cy9iYXNlVWkvdXNlckNhcmQudnVlIjsKCmltcG9ydCB7IEdldFF1ZXJ5U3RyaW5nIH0gZnJvbSAiLi4vLi4vdXRpbHMvdXRpbHMiOwppbXBvcnQgUmVxdWVzdCBmcm9tICIuLi8uLi9yZXF1ZXN0L2luZGV4LmpzIjsKaW1wb3J0IGNvbmZpZyBmcm9tICIuLi8uLi9jb25maWciOwoKLy8gaW1wb3J0IENhbGxSb29tIGZyb20gIi4vY2FsbFJvb20vaW5kZXgudnVlIjsKLy8gaW1wb3J0IFBvcHVwSW5wdXQgZnJvbSAiLi4vLi4vY29tcG9uZW50cy9Qb3B1cElucHV0LnZ1ZSI7CgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIlJvb21saXZlIiwKICBkYXRhOiBmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gewogICAgICAvLyBtc2c6ICJjY2MiLAogICAgICB2aWRlb05vZGU6IHRoaXMuJHJlZnMudmlkZW8sCiAgICAgIG1pbmlOb2RlOiB0aGlzLiRyZWZzLnZpZGVvSW5WaWRlbywKICAgICAgc2hvd0dpZnQ6IGZhbHNlLAoKICAgICAgaXNBbmNob3I6IGZhbHNlLAogICAgICBzdGF0dXM6IDIsIC8vIDAg5Li75pKt5byA5pKtIDEg5Li75pKt5qih5byPIDIg6KeC5LyX5qih5byPCiAgICAgIG5ld3Jvb206IGZhbHNlLCAvL+aYr+WQpuaWsOW7uuaIv+mXtAogICAgICByb29tSWQ6ICIiLCAvL+acrOaIv+mXtGlkCiAgICAgIHVzZXJBdmF0YXI6ICIiLCAvL+S4u+aSreWktOWDjwogICAgICB1c2VyTmFtZTogIiIsIC8v5Li75pKt5ZCN5a2XCiAgICAgIHJvb21OYW1lOiAiIiwgLy/miL/pl7TlkI3lrZcKICAgICAgZGVsYXk6IDAsIC8v5oi/6Ze05bu26L+fCiAgICAgIHVzZXJJZDogIiIsIC8v5Li75pKt55qEaWQKICAgICAgZ2lmdE51bTogMCwgLy/lvZPliY3kuLvmkq3mlLbliLDnmoTnpLznianmgLvph48KICAgICAgaXNQcml2YXRlOiAiIiwgLy/mmK/lkKbnp4Hlr4YKCiAgICAgIHNlYXRJbmZvTGlzdDogW10sIC8v6bqm5L2N5L+h5oGvCiAgICAgIHVzZXJsaXN0OiB7fSwgLy/ov5vlhaXov4fmiL/pl7TnmoTnlKjmiLfliJfooagKICAgICAgUm9vbUZpdEl0ZW1MaXN0OiBbXSwKICAgICAgcWl1dENvbmZpcm06IGZhbHNlLCAvL+S4u+aSremAgOWHuuehruiupAogICAgICBxdWl0TWljOiBmYWxzZSwgLy/lsZXnpLrkuIvpuqbnlYzpnaIKICAgICAgZGVmYXVsdEF2YXRhclVybDoKICAgICAgICAiaHR0cHM6Ly9jZG4ucm9uZ2h1Yi5jb20vZGVtby9kZWZhdWx0L3JjZV9kZWZhdWx0X2F2YXRhci5wbmciLAogICAgICBkZWZhdWx0QWRkcmVzczogY29uZmlnLnBpY1BhdGgsCiAgICB9OwogIH0sCiAgY29tcG9uZW50czogewogICAgbGl2ZUNyZWF0ZSwKICAgIGxpdmVUaXRsZSwKICAgIHZpZGVvQm94LAogICAgbGl2ZUNoYXQsCiAgICBib3R0b21CYXIsCiAgICBnaWZ0UGFuZWwsCiAgICBsaXZlQXVkaWVuY2UsCiAgICByb29tQmFjaywKICAgIENvbm5ldFdlYXQsCiAgICBSb29tRml0LAogICAgTm90aWNlLAogICAgbGl2ZVF1aXRTZWF0LAogICAgQ2FuY2VsRXZlblNlYXQsCiAgICBVc2VyTGlzdCwKICAgIFVzZXJDYXJkLAogIH0sCiAgbWV0aG9kczogewogICAgLy/liJvlu7rmiL/pl7QKICAgIGluaXQ6IGZ1bmN0aW9uICgpIHsKICAgICAgY29uc29sZS5sb2coIuWIneWni+WMluaIv+mXtCAiKTsKICAgICAgdGhpcy4kZGF0YS5zZWF0SW5mb0xpc3QgPSB0aGlzLiRSQ0xpdmVSb29tTGliLnNlYXRJbmZvTGlzdDsgLy/mm7TmlrDpuqbkvY3kv6Hmga8KICAgICAgdGhpcy5nZXRSb29taW5mb3JtYXRpb24oKTsKICAgICAgdGhpcy5nZXRVc2VyTGlzdCgpOwogICAgICB0aGlzLiRSQ0xpdmVSb29tTGliLm9uKCJSdGNSdHQiLCAoUnRjUnR0KSA9PiB7CiAgICAgICAgdGhpcy4kZGF0YS5kZWxheSA9IFJ0Y1J0dDsKICAgICAgfSk7CiAgICB9LAogICAgQ29ubmVjdE1pYzogZnVuY3Rpb24gKCkgewogICAgICB0aGlzLiRyZWZzLkNvbm5ldFdlYXQub3BlbkNvbm5ldFdoZWF0KGZhbHNlKTsKICAgIH0sCiAgICAvL+aJk+W8gOWFrOWRigogICAgY2xpY2tOb3RpY2U6IGZ1bmN0aW9uICgpIHsKICAgICAgY29uc29sZS5sb2codGhpcy4kUkNMaXZlUm9vbUxpYik7CiAgICAgIHRoaXMuJHJlZnMuTm90aWNlLnNldFBvcHVwKHsKICAgICAgICBpc1Nob3c6IGZhbHNlLAogICAgICAgIHZhbHVlOiB0aGlzLiRSQ0xpdmVSb29tTGliLmltLl9yb29tTm90aWNlCiAgICAgICAgICA/IHRoaXMuJFJDTGl2ZVJvb21MaWIuaW0uX3Jvb21Ob3RpY2UKICAgICAgICAgIDogIuasoui/juadpeWIsCAiICsgdGhpcy4kc3RvcmUuc3RhdGUucm9vbVRpdGxlLAogICAgICB9KTsKICAgIH0sCiAgICBvbkNsb3NlVXNlckxpc3Q6IGZ1bmN0aW9uICgpIHsKICAgICAgY29uc29sZS5sb2coIm9uQ2xvc2VVc2VyTGlzdCIpOwogICAgfSwKICAgIG9uQ2xpY2tVc2VyTGlzdDogZnVuY3Rpb24gKCkgewogICAgICBjb25zb2xlLmxvZygib25DbGlja1VzZXJMaXN0Iik7CiAgICB9LAogICAgbWludmlkZW9DbGlja2VkOiBmdW5jdGlvbiAoKSB7CiAgICAgIGlmICgKICAgICAgICB0aGlzLiRSQ0xpdmVSb29tTGliLmltLnNlYXRJbmZvTGlzdCAmJgogICAgICAgIHRoaXMuJFJDTGl2ZVJvb21MaWIuaW0uc2VhdEluZm9MaXN0WzFdICYmCiAgICAgICAgdGhpcy4kUkNMaXZlUm9vbUxpYi5pbS5zZWF0SW5mb0xpc3RbMV0udXNlcklkICE9ICIiCiAgICAgICkgewogICAgICAgIC8vMeWPt+m6puS9jeS4iuacieS6ugogICAgICAgIHRoaXMuJGRhdGEucXVpdE1pYyA9IHRydWU7CiAgICAgIH0KICAgIH0sCiAgICBhdWRpZW5jZUxpc3Q6IGZ1bmN0aW9uICgpIHsKICAgICAgUmVxdWVzdC5yb29tdXNlcih7CiAgICAgICAgcm9vbUlkOiB0aGlzLiRSQ0xpdmVSb29tTGliLl9yb29taWRjbGksCiAgICAgIH0pLnRoZW4oKHJlcykgPT4gewogICAgICAgIGNvbnNvbGUubG9nKHJlcyk7CiAgICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goImdldFJvb21Vc2VyTGlzdCIsIHJlcy5kYXRhLmRhdGEpOwogICAgICB9KTsKICAgICAgdGhpcy5ob3VzZUZpbHRlciA9IDU7CiAgICAgIHRoaXMuJHJlZnMuVXNlckxpc3Qub3BlblVzZXJMaXN0KCk7CiAgICB9LAogICAgZ2V0Um9vbWluZm9ybWF0aW9uOiBmdW5jdGlvbiAoKSB7CiAgICAgIFJlcXVlc3Qucm9vbWluZm9ybWF0aW9uKHsgcm9vbUlkOiB0aGlzLiRSQ0xpdmVSb29tTGliLl9yb29taWRjbGkgfSkKICAgICAgICAudGhlbigocmVzKSA9PiB7CiAgICAgICAgICBpZiAocmVzLmRhdGEuY29kZSA9PSAxMDAwMCkgewogICAgICAgICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgiZ2V0Um9vbUluZm9ybWF0aW9uIiwgcmVzLmRhdGEuZGF0YSk7CiAgICAgICAgICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKAogICAgICAgICAgICAgICJnZXRyb29tQmFja2dyb3VuZCIsCiAgICAgICAgICAgICAgcmVzLmRhdGEuZGF0YS5iYWNrZ3JvdW5kVXJsCiAgICAgICAgICAgICk7CgogICAgICAgICAgICB0aGlzLiRkYXRhLnJvb21OYW1lID0gcmVzLmRhdGEuZGF0YS5yb29tTmFtZTsKICAgICAgICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goImdldHJvb21UaXRsZSIsIHJlcy5kYXRhLmRhdGEucm9vbU5hbWUpOwogICAgICAgICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgiZ2V0cm9vbVByaXZhdGUiLCB7CiAgICAgICAgICAgICAgaXNQcml2YXRlOiByZXMuZGF0YS5kYXRhLmlzUHJpdmF0ZSwKICAgICAgICAgICAgICBwYXNzd29yZDogcmVzLmRhdGEuZGF0YS5wYXNzd29yZCwKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHRoaXMuJHJlZnMuY2hhdHJvb20ud2VsY29tZSgpOwogICAgICAgICAgICB0aGlzLiRkYXRhLnVzZXJsaXN0W3Jlcy5kYXRhLmRhdGEuY3JlYXRlVXNlci51c2VySWRdID0KICAgICAgICAgICAgICByZXMuZGF0YS5kYXRhLmNyZWF0ZVVzZXI7CgogICAgICAgICAgICBpZiAocmVzLmRhdGEuZGF0YS5jcmVhdGVVc2VyLnBvcnRyYWl0KSB7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coIuW6lOeUqOS6huWktOWDjyIsIHRoaXMuJGRhdGEuZGVmYXVsdEF2YXRhclVybCk7CiAgICAgICAgICAgICAgdGhpcy4kZGF0YS51c2VyQXZhdGFyID0KICAgICAgICAgICAgICAgIHRoaXMuJGRhdGEuZGVmYXVsdEFkZHJlc3MgKyByZXMuZGF0YS5kYXRhLmNyZWF0ZVVzZXIucG9ydHJhaXQ7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coIuW6lOeUqOS6hum7mOiupOWktOWDjyIsIHRoaXMuJGRhdGEuZGVmYXVsdEF2YXRhclVybCk7CiAgICAgICAgICAgICAgdGhpcy4kZGF0YS51c2VyQXZhdGFyID0gdGhpcy4kZGF0YS5kZWZhdWx0QXZhdGFyVXJsOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHRoaXMuJGRhdGEudXNlck5hbWUgPSByZXMuZGF0YS5kYXRhLmNyZWF0ZVVzZXIudXNlck5hbWU7CiAgICAgICAgICAgIHRoaXMuJGRhdGEudXNlcklkID0gcmVzLmRhdGEuZGF0YS5jcmVhdGVVc2VyLnVzZXJJZDsKICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgIHRoaXMuJHN0b3JlLnN0YXRlLnVzZXJJbmZvLnVzZXJJZCA9PQogICAgICAgICAgICAgIHJlcy5kYXRhLmRhdGEuY3JlYXRlVXNlci51c2VySWQKICAgICAgICAgICAgKSB7CiAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuc3RhdGUuY3JlYXRVc2VyID0gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBjb25zb2xlLmxvZygic3RhdGUiLCB0aGlzLiRzdG9yZS5zdGF0ZS51c2VySW5mby51c2VySWQpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY29uc29sZS5sb2coImVyciIsIHJlcy5kYXRhKTsKICAgICAgICAgIH0KICAgICAgICB9KQogICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7CiAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpOwogICAgICAgIH0pOwogICAgfSwKICAgIGdldFVzZXJMaXN0OiBmdW5jdGlvbiAoKSB7CiAgICAgIFJlcXVlc3Qucm9vbXVzZXIoewogICAgICAgIHJvb21JZDogdGhpcy4kUkNMaXZlUm9vbUxpYi5fcm9vbWlkY2xpLAogICAgICB9KS50aGVuKChyZXMpID0+IHsKICAgICAgICBjb25zb2xlLmxvZygi5b2T5YmN5oi/6Ze055So5oi3IiwgcmVzKTsKICAgICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgiZ2V0Um9vbVVzZXJMaXN0IiwgcmVzLmRhdGEuZGF0YSk7CiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCByZXMuZGF0YS5kYXRhLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICB0aGlzLiRkYXRhLnVzZXJsaXN0W3Jlcy5kYXRhLmRhdGFbaV0udXNlcklkXSA9IHJlcy5kYXRhLmRhdGFbaV07CiAgICAgICAgfQogICAgICAgIHRoaXMuZ2V0R2lmdEFuZE1hbigpOwogICAgICB9KTsKICAgIH0sCiAgICAvL+iOt+WPlmdpZnTlkoznrqHnkIblkZgKICAgIGdldEdpZnRBbmRNYW46IGZ1bmN0aW9uICgpIHsKICAgICAgY29uc29sZS5sb2coImdldEdpZnRBbmRNYW4gY2FsbGVkIik7CiAgICAgIFByb21pc2UuYWxsKFt0aGlzLmdldEdpZnRMaXN0KCksIHRoaXMuZ2V0TWFuYWdlTGlzdCgpXSkKICAgICAgICAudGhlbigocmVzKSA9PiB7CiAgICAgICAgICBjb25zb2xlLmxvZyhyZXMpOwogICAgICAgICAgaWYgKHRoaXMuJFJDTGl2ZVJvb21MaWIuaW0udXNlcklkIGluIHJlc1sxXVsiTWFuYWdlT2JqIl0pIHsKICAgICAgICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goInNldFJvb21BZG1pbiIsIHRydWUpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goInNldFJvb21BZG1pbiIsIGZhbHNlKTsKICAgICAgICAgIH0KICAgICAgICAgIC8vIC8vIGNvbnNvbGUubG9nKHRoaXMuJHN0b3JlLnN0YXRlLnJvb21Vc2VyTGlzdCk7CiAgICAgICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7CiAgICAgICAgICAgIGxldCBPYmogPSB7fTsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCByZXMubGVuZ3RoOyBpICs9IDEpIHsKICAgICAgICAgICAgICBPYmogPSB7CiAgICAgICAgICAgICAgICAuLi5PYmosCiAgICAgICAgICAgICAgICAuLi5yZXNbaV0sCiAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfQogICAgICAgICAgICB0aGlzLkdpZnRBbmRNYW5hZ2VMaXN0ID0gewogICAgICAgICAgICAgIC4uLk9iaiwKICAgICAgICAgICAgfTsKICAgICAgICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goImdldEdpZnRBbmRNYW5hZ2VMaXN0IiwgT2JqKTsKICAgICAgICAgICAgLy8gY29uc29sZS5sb2coT2JqKTsKICAgICAgICAgICAgdGhpcy5TZXRTZWF0TGlzdChPYmopOwogICAgICAgICAgfSk7CiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goKGVycikgPT4gewogICAgICAgICAgY29uc29sZS5sb2coImVyciIsIGVycik7CiAgICAgICAgfSk7CiAgICB9LAogICAgLy/orr7nva7luqfkvY1MaXN0CiAgICBTZXRTZWF0TGlzdDogYXN5bmMgZnVuY3Rpb24gKHJlc1ZhbHVlKSB7CiAgICAgIGNvbnNvbGUubG9nKCJHaWZ0QW5kTWFuYWdlTGlzdDoiLCByZXNWYWx1ZSk7CiAgICAgIHRoaXMuaG91c2VyTWFwID0ge307CiAgICAgIGxldCByb29tVXNlckxpc3RNYXAgPSB7fTsKICAgICAgdGhpcy5pdGVtTGlzdCA9IFtdOwoKICAgICAgaWYgKHRoaXMuJHN0b3JlLnN0YXRlLnJvb21Vc2VyTGlzdC5sZW5ndGggPT0gMCkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgY29uc29sZS5sb2codGhpcy4kUkNMaXZlUm9vbUxpYi5zZWF0SW5mb0xpc3QpOwogICAgICBpZiAoIXRoaXMuJFJDTGl2ZVJvb21MaWIuc2VhdEluZm9MaXN0WzBdKSB7CiAgICAgICAgdGhpcy4kUkNMaXZlUm9vbUxpYi5zZWF0SW5mb0xpc3RbMF0gPSB7CiAgICAgICAgICAuLi50aGlzLnNlYXRJbmZvLAogICAgICAgIH07CgogICAgICAgIC8vIHRoaXMuJFJDTGl2ZVJvb21MaWIuc2VhdEluZm9MaXN0WzBdID0gSlNPTi5wYXJzZSgKICAgICAgICAvLyAgIEpTT04uc3RyaW5naWZ5KHRoaXMuc2VhdEluZm8pCiAgICAgICAgLy8gKTsKICAgICAgICB0aGlzLiRSQ0xpdmVSb29tTGliLnNlYXRJbmZvTGlzdFswXVsic3RhdHVzIl0gPSAxOwogICAgICAgIHRoaXMuJFJDTGl2ZVJvb21MaWIuc2VhdEluZm9MaXN0WzBdWyJ1c2VySWQiXSA9CiAgICAgICAgICB0aGlzLiRzdG9yZS5zdGF0ZS5yb29tSW5mb3JtYXRpb24uY3JlYXRlVXNlci51c2VySWQ7CiAgICAgICAgLy8gdGhpcy4kUkNMaXZlUm9vbUxpYi5zZWF0SW5mb0xpc3RbMF1bJ3BvcnRyYWl0J109dGhpcy4kc3RvcmUuc3RhdGUucm9vbUluZm9ybWF0aW9uLmNyZWF0ZVVzZXIucG9ydHJhaXQKICAgICAgfQogICAgICBjb25zb2xlLmxvZyh0aGlzLiRSQ0xpdmVSb29tTGliLnNlYXRJbmZvTGlzdFswXSk7CiAgICAgIGZvciAobGV0IG0gPSAwOyBtIDwgdGhpcy4kc3RvcmUuc3RhdGUucm9vbVVzZXJMaXN0Lmxlbmd0aDsgbSArPSAxKSB7CiAgICAgICAgcm9vbVVzZXJMaXN0TWFwW3RoaXMuJHN0b3JlLnN0YXRlLnJvb21Vc2VyTGlzdFttXVsidXNlcklkIl1dID0KICAgICAgICAgIHRoaXMuJHN0b3JlLnN0YXRlLnJvb21Vc2VyTGlzdFttXTsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuJFJDTGl2ZVJvb21MaWIuc2VhdEluZm9MaXN0WzBdWyJtdXRlIl0gIT0gIXRoaXMuT3dlck11dGUpIHsKICAgICAgICB0aGlzLk93ZXJNdXRlID0gIXRoaXMuJFJDTGl2ZVJvb21MaWIuc2VhdEluZm9MaXN0WzBdWyJtdXRlIl07CiAgICAgIH0KCiAgICAgIGlmICgKICAgICAgICB0aGlzLiRSQ0xpdmVSb29tTGliLnNlYXRJbmZvTGlzdFswXVsidXNlcklkIl0gJiYKICAgICAgICB0aGlzLiRSQ0xpdmVSb29tTGliLnNlYXRJbmZvTGlzdFswXVsidXNlcklkIl0gaW4gcm9vbVVzZXJMaXN0TWFwCiAgICAgICkgewogICAgICAgIHRoaXMuaG91c2VyTWFwID0gewogICAgICAgICAgLi4ucm9vbVVzZXJMaXN0TWFwW3RoaXMuJFJDTGl2ZVJvb21MaWIuc2VhdEluZm9MaXN0WzBdWyJ1c2VySWQiXV0sCiAgICAgICAgfTsKICAgICAgfQoKICAgICAgaWYgKAogICAgICAgIHRoaXMuJFJDTGl2ZVJvb21MaWIuc2VhdEluZm9MaXN0WzBdWyJ1c2VySWQiXSAmJgogICAgICAgIHRoaXMuJFJDTGl2ZVJvb21MaWIuc2VhdEluZm9MaXN0WzBdWyJ1c2VySWQiXSBpbiByZXNWYWx1ZS5HaWZ0T2JqCiAgICAgICkgewogICAgICAgIHRoaXMuaG91c2VyTWFwID0gewogICAgICAgICAgLi4udGhpcy5ob3VzZXJNYXAsCiAgICAgICAgICBnaWZ0OiByZXNWYWx1ZS5HaWZ0T2JqW3RoaXMuJFJDTGl2ZVJvb21MaWIuc2VhdEluZm9MaXN0WzBdWyJ1c2VySWQiXV0sCiAgICAgICAgfTsKICAgICAgfQoKICAgICAgdGhpcy5ob3VzZXJNYXAgPSB7CiAgICAgICAgLi4udGhpcy5ob3VzZXJNYXAsCiAgICAgICAgLi4udGhpcy4kUkNMaXZlUm9vbUxpYi5zZWF0SW5mb0xpc3RbMF0sCiAgICAgIH07CgogICAgICBsZXQgYXJyID0gW107CiAgICAgIC8vIGNvbnNvbGUubG9nKAogICAgICAvLyAgICJ0aGlzLiRSQ0xpdmVSb29tTGliLnJvb21JbmZvIiwKICAgICAgLy8gICB0aGlzLiRSQ0xpdmVSb29tTGliLnJvb21JbmZvCiAgICAgIC8vICk7CiAgICAgIGxldCBzZWF0Q291bnROdW1iZXIgPSA5OwoKICAgICAgZm9yIChsZXQgcCA9IDE7IHAgPCBzZWF0Q291bnROdW1iZXI7IHAgKz0gMSkgewogICAgICAgIGxldCBPdGhlck1hcCA9IHt9OwogICAgICAgIGlmICgKICAgICAgICAgIHRoaXMuJFJDTGl2ZVJvb21MaWIuc2VhdEluZm9MaXN0W3BdICYmCiAgICAgICAgICB0aGlzLiRSQ0xpdmVSb29tTGliLnNlYXRJbmZvTGlzdFtwXVsidXNlcklkIl0KICAgICAgICApIHsKICAgICAgICAgIGlmICgKICAgICAgICAgICAgdGhpcy4kUkNMaXZlUm9vbUxpYi5zZWF0SW5mb0xpc3RbcF1bInVzZXJJZCJdIGluIHJvb21Vc2VyTGlzdE1hcAogICAgICAgICAgKSB7CiAgICAgICAgICAgIE90aGVyTWFwID0gewogICAgICAgICAgICAgIC4uLnJvb21Vc2VyTGlzdE1hcFt0aGlzLiRSQ0xpdmVSb29tTGliLnNlYXRJbmZvTGlzdFtwXVsidXNlcklkIl1dLAogICAgICAgICAgICB9OwogICAgICAgICAgfQoKICAgICAgICAgIGlmICgKICAgICAgICAgICAgdGhpcy4kUkNMaXZlUm9vbUxpYi5zZWF0SW5mb0xpc3RbcF1bInVzZXJJZCJdIGluIHJlc1ZhbHVlLk1hbmFnZU9iagogICAgICAgICAgKSB7CiAgICAgICAgICAgIE90aGVyTWFwID0gewogICAgICAgICAgICAgIC4uLk90aGVyTWFwLAogICAgICAgICAgICAgIGlzQWRtaW46IHRydWUsCiAgICAgICAgICAgIH07CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKAogICAgICAgICAgICB0aGlzLiRSQ0xpdmVSb29tTGliLnNlYXRJbmZvTGlzdFtwXVsidXNlcklkIl0gaW4gcmVzVmFsdWUuR2lmdE9iagogICAgICAgICAgKSB7CiAgICAgICAgICAgIE90aGVyTWFwID0gewogICAgICAgICAgICAgIC4uLk90aGVyTWFwLAogICAgICAgICAgICAgIGdpZnQ6IHJlc1ZhbHVlLkdpZnRPYmpbCiAgICAgICAgICAgICAgICB0aGlzLiRSQ0xpdmVSb29tTGliLnNlYXRJbmZvTGlzdFtwXVsidXNlcklkIl0KICAgICAgICAgICAgICBdLAogICAgICAgICAgICB9OwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKHRoaXMuJFJDTGl2ZVJvb21MaWIuc2VhdEluZm9MaXN0W3BdKSB7CiAgICAgICAgICBhcnIucHVzaCh7CiAgICAgICAgICAgIC4uLk90aGVyTWFwLAogICAgICAgICAgICAuLi50aGlzLiRSQ0xpdmVSb29tTGliLnNlYXRJbmZvTGlzdFtwXSwKICAgICAgICAgICAgaW5kZXg6IHAsCiAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy4kUkNMaXZlUm9vbUxpYi5zZWF0SW5mb0xpc3RbcF0gPSB7CiAgICAgICAgICAgIC4uLnRoaXMuc2VhdEluZm8sCiAgICAgICAgICB9OwogICAgICAgICAgYXJyLnB1c2goewogICAgICAgICAgICAuLi5PdGhlck1hcCwKICAgICAgICAgICAgLi4udGhpcy5zZWF0SW5mbywKICAgICAgICAgICAgaW5kZXg6IHAsCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0KICAgICAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IGFyci5sZW5ndGg7IGluZGV4ICs9IDEpIHsKICAgICAgICBpZiAodGhpcy4kUkNMaXZlUm9vbUxpYi5pbS51c2VySWQgPT0gYXJyW2luZGV4XS51c2VySWQpIHsKICAgICAgICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCJ1cGRhdGV1c2VySW5zZWF0IiwgdHJ1ZSk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgICAgaWYgKGluZGV4ID09IGFyci5sZW5ndGggLSAxKSB7CiAgICAgICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgidXBkYXRldXNlckluc2VhdCIsIGZhbHNlKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgdGhpcy5pdGVtTGlzdCA9IGFycjsKICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goInVwZGF0ZUl0ZW1MaXN0IiwgYXJyKTsKCiAgICAgIC8vICBjb25zb2xlLmxvZyh0aGlzLiRSQ0xpdmVSb29tTGliLnNlYXRJbmZvTGlzdCk7CiAgICAgIC8vIGNvbnNvbGUubG9nKCJPdGhlckxpc3QiLCBhcnIpOwogICAgICAvLyBjb25zb2xlLmxvZygidGhpcy5ob3VzZXJNYXAiLCB0aGlzLmhvdXNlck1hcCk7CiAgICB9LAogICAgLy/miL/kuLvorr7nva7nirbmgIHmjqfliLYKICAgIENvbm5lY3RPcGVyYXRpb246IGZ1bmN0aW9uICgpIHsKICAgICAgLy8gY29uc29sZS5sb2codGhpcy4kUkNMaXZlUm9vbUxpYi5yb29tSW5mbyk7CiAgICAgIC8vIGNvbnN0IFJvb21GaXRMaXN0ID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShSb29tRml0SXRlbUxpc3QpKTsKICAgICAgY29uc3QgUm9vbUZpdExpc3QgPSBbCiAgICAgICAgewogICAgICAgICAgdmFsdWU6ICLmiL/pl7TkuIrplIEiLAogICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXVuZGVmCiAgICAgICAgICBpbWc6ICJ1cmwoIiArIHJlcXVpcmUoIi4uLy4uL2Fzc2V0cy9yb29taWNvbi9Mb2NrUm9vbi5wbmciKSArICIpIiwKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHZhbHVlOiAi5oi/6Ze05qCH6aKYIiwKICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby11bmRlZgogICAgICAgICAgaW1nOiAidXJsKCIgKyByZXF1aXJlKCIuLi8uLi9hc3NldHMvcm9vbWljb24vUm9vbVRpdGxlLnBuZyIpICsgIikiLAogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgdmFsdWU6ICLmiL/pl7TlhazlkYoiLAogICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXVuZGVmCiAgICAgICAgICBpbWc6ICJ1cmwoIiArIHJlcXVpcmUoIi4uLy4uL2Fzc2V0cy9yb29taWNvbi9Sb29tTm90aWNlLnBuZyIpICsgIikiLAogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgdmFsdWU6ICLlsY/olL3or40iLAogICAgICAgICAgaW1nOgogICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW5kZWYKICAgICAgICAgICAgInVybCgiICsgcmVxdWlyZSgiLi4vLi4vYXNzZXRzL3Jvb21pY29uL1NoaWVsZGluZ1dvcmRzLnBuZyIpICsgIikiLAogICAgICAgIH0sCiAgICAgIF07CgogICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLiRzdG9yZS5zdGF0ZS5yb29tUHJpdmF0ZSk7CiAgICAgIGlmICh0aGlzLiRzdG9yZS5zdGF0ZS5yb29tUHJpdmF0ZS5pc1ByaXZhdGUgPT0gMSkgewogICAgICAgIFJvb21GaXRMaXN0WzBdID0gewogICAgICAgICAgdmFsdWU6ICLmiL/pl7Top6PplIEiLAogICAgICAgICAgaW1nOgogICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW5kZWYKICAgICAgICAgICAgInVybCgiICsgcmVxdWlyZSgiLi4vLi4vYXNzZXRzL3Jvb21pY29uL1VuTG9ja1Jvb20ucG5nIikgKyAiKSIsCiAgICAgICAgfTsKICAgICAgfQogICAgICBjb25zb2xlLmxvZygi5p6E5bu677yaIiwgdGhpcy4kc3RvcmUuc3RhdGUuaXNGcmVlRW50ZXJTZWF0KTsKICAgICAgaWYgKHRoaXMuJHN0b3JlLnN0YXRlLmlzRnJlZUVudGVyU2VhdCkgewogICAgICAgIFJvb21GaXRMaXN0LnB1c2goewogICAgICAgICAgdmFsdWU6ICLnlLPor7fkuIrpuqYiLAogICAgICAgICAgaW1nOgogICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW5kZWYKICAgICAgICAgICAgInVybCgiICsgcmVxdWlyZSgiLi4vLi4vYXNzZXRzL3Jvb21pY29uL0JBcHBseVdoZWF0LnBuZyIpICsgIikiLAogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIFJvb21GaXRMaXN0LnB1c2goewogICAgICAgICAgdmFsdWU6ICLoh6rnlLHkuIrpuqYiLAogICAgICAgICAgaW1nOgogICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW5kZWYKICAgICAgICAgICAgInVybCgiICsgcmVxdWlyZSgiLi4vLi4vYXNzZXRzL3Jvb21pY29uL0JGcmVlV2hlYXQucG5nIikgKyAiKSIsCiAgICAgICAgfSk7CiAgICAgIH0KICAgICAgdGhpcy5Sb29tRml0SXRlbUxpc3QgPSBSb29tRml0TGlzdDsKICAgICAgLy8gY29uc29sZS5sb2codGhpcy5Sb29tRml0SXRlbUxpc3QpOwogICAgICB0aGlzLiRyZWZzLlJvb21GaXQub3BlblJvb21GaXQoKTsKICAgIH0sCiAgICAvL+ivt+axguaOkum6puS4juWQpgogICAgQXBwbHlXZWF0OiBhc3luYyBmdW5jdGlvbiAoKSB7CiAgICAgIGlmICh0aGlzLiRzdG9yZS5zdGF0ZS5IYXNBcHBseSkgewogICAgICAgIHRoaXMuJHJlZnMuQ2FuY2VsRXZlblNlYXQuQ2FuY2VsRXZlblNlYXRPcGVuKCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaWYgKHRoaXMuJFJDTGl2ZVJvb21MaWIuaW0uX0ZyZWVFbnRlclNlYXQpIHsKICAgICAgICAgIC8v6Ieq55Sx5LiK6bqm55qE5oOF5Ya1CiAgICAgICAgICBpZiAoCiAgICAgICAgICAgIHRoaXMuJFJDTGl2ZVJvb21MaWIuaW0uc2VhdEluZm9MaXN0WzFdICYmCiAgICAgICAgICAgIHRoaXMuJFJDTGl2ZVJvb21MaWIuaW0uc2VhdEluZm9MaXN0WzFdLnVzZXJJZCAmJgogICAgICAgICAgICB0aGlzLiRSQ0xpdmVSb29tTGliLmltLnNlYXRJbmZvTGlzdFsxXS51c2VySWQubGVuZ3RoCiAgICAgICAgICApIHsKICAgICAgICAgICAgY29uc29sZS5sb2codGhpcy4kUkNMaXZlUm9vbUxpYi5pbS5zZWF0SW5mb0xpc3RbMV0pOwogICAgICAgICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgic2hvd1RvYXN0IiwgewogICAgICAgICAgICAgIHZhbHVlOiAi6bqm5L2N5bey5ruhIiwKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0aGlzLiRSQ0xpdmVSb29tTGliLnJlcXVlc3RTZWF0KCk7CiAgICAgICAgICAgIC8vICB0aGlzLiRSQ0xpdmVSb29tTGliLmVudGVyU2VhdCgxKTsKICAgICAgICAgICAgdGhpcy4kc3RvcmUuc3RhdGUub25MaW5rID0gdHJ1ZTsKICAgICAgICAgICAgdGhpcy4kc3RvcmUuc3RhdGUub25NaWMgPSB0cnVlOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGF3YWl0IHRoaXMuJFJDTGl2ZVJvb21MaWIucmVxdWVzdFNlYXQoKTsKICAgICAgICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCJzaG93VG9hc3QiLCB7CiAgICAgICAgICAgIHZhbHVlOiAi5bey55Sz6K+36L+e57q/77yM562J5b6F5oi/5Li75o6l5Y+XIiwKICAgICAgICAgIH0pOwogICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCJ1c2VySGFzQXBwbHkiLCB0cnVlKTsKICAgICAgICAgIH0sIDUwKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgLy8gY29uc29sZS5sb2codGhpcy4kc3RvcmUuc3RhdGUuSGFzQXBwbHkpOwogICAgfSwKICAgIGdldFNlYXRJbmZvbGlzdDogYXN5bmMgZnVuY3Rpb24gKCkgewogICAgICBjb25zdCBsaXN0ID0gYXdhaXQgdGhpcy4kUkNMaXZlUm9vbUxpYi5nZXRMYXRlc3RTZWF0SW5mbygpOwogICAgICBjb25zb2xlLmxvZyhsaXN0KTsKICAgIH0sCiAgICBjcmVhdGVSb29tOiBmdW5jdGlvbiAoKSB7CiAgICAgIGNvbnNvbGUubG9nKCJjcnRSb29tPT09IiwgdGhpcy4kcmVmcy52aWRlbywgdGhpcy4kcmVmcy52aWRlb0luVmlkZW8pOwoKICAgICAgY29uc29sZS5sb2coIuW9k+WJjeeUqOaIt++8miIsIHRoaXMuJHN0b3JlLnN0YXRlKTsKICAgICAgdGhpcy4kUkNMaXZlUm9vbUxpYgogICAgICAgIC5jcmVhdGVBbmRKb2luUm9vbSh7CiAgICAgICAgICByb29tSWQ6IHRoaXMuJGRhdGEucm9vbUlkLAogICAgICAgICAgcm9vbU5hbWU6IHRoaXMuJGRhdGEucm9vbU5hbWUsCiAgICAgICAgICByb29tVHlwZTogImxpdmUiLAogICAgICAgICAgdmlkZW9Ob2RlOiB0aGlzLiRyZWZzLnZpZGVvLAogICAgICAgICAgbWluaU5vZGU6IHRoaXMuJHJlZnMudmlkZW9JblZpZGVvLAogICAgICAgIH0pCiAgICAgICAgLnRoZW4oKCkgPT4gewogICAgICAgICAgdGhpcy5pbml0KCk7CiAgICAgICAgfSk7CiAgICB9LAogICAgam9pbnJvb206IGZ1bmN0aW9uICgpIHsKICAgICAgY29uc29sZS5sb2coInNka+WKoOWFpeaIv+mXtOWKqOS9nCIpOwogICAgICB0aGlzLiRSQ0xpdmVSb29tTGliCiAgICAgICAgLmpvaW5Sb29tKHsKICAgICAgICAgIHJvb21JZDogR2V0UXVlcnlTdHJpbmcoInJvb21pZCIpLAogICAgICAgICAgcm9vbVR5cGU6ICJsaXZlIiwKICAgICAgICAgIHZpZGVvTm9kZTogdGhpcy4kcmVmcy52aWRlbywKICAgICAgICAgIG1pbmlOb2RlOiB0aGlzLiRyZWZzLnZpZGVvSW5WaWRlbywKICAgICAgICB9KQogICAgICAgIC50aGVuKCgpID0+IHsKICAgICAgICAgIHRoaXMuaW5pdCgpOwogICAgICAgIH0pOwogICAgfSwKICAgIHF1aXRSb29tOiBmdW5jdGlvbiAoKSB7CiAgICAgIGlmICh0aGlzLiRkYXRhLmlzQW5jaG9yKSB7CiAgICAgICAgdGhpcy4kZGF0YS5xaXV0Q29uZmlybSA9IHRydWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbGV0IEJhY2tMaXN0ICA9W107CiAgICAgICAgaWYodGhpcy4kc3RvcmUuc3RhdGUub25NaWMpey8v5Zyo6bqm5L2N5LiK5pe25LiN5YWB6K645pS26LW35oi/6Ze0CiAgICAgICAgICBCYWNrTGlzdCA9IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIHZhbHVlOiAi56a75byA5oi/6Ze0IiwKICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW5kZWYKICAgICAgICAgICAgICBpbWc6ICJ1cmwoIiArIHJlcXVpcmUoIi4uLy4uL2Fzc2V0cy9yb29taWNvbi9DbG9zZVJvb20ucG5nIikgKyAiKSIsCiAgICAgICAgICAgIH1dCiAgICAgICAgfWVsc2V7CiAgICAgICAgICBCYWNrTGlzdCA9IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIHZhbHVlOiAi5pS26LW35oi/6Ze0IiwKICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW5kZWYKICAgICAgICAgICAgICBpbWc6ICJ1cmwoIiArIHJlcXVpcmUoIi4uLy4uL2Fzc2V0cy9yb29taWNvbi9MZWF2ZVJvb20ucG5nIikgKyAiKSIsCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICB2YWx1ZTogIuemu+W8gOaIv+mXtCIsCiAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXVuZGVmCiAgICAgICAgICAgICAgaW1nOiAidXJsKCIgKyByZXF1aXJlKCIuLi8uLi9hc3NldHMvcm9vbWljb24vQ2xvc2VSb29tLnBuZyIpICsgIikiLAogICAgICAgICAgICB9LAogICAgICAgICAgXTsKICAgICAgICB9CiAgICAgICAgY29uc29sZS5sb2codGhpcy4kcmVmcy5Sb29tQmFjay5Sb29tQmFja09wZW4pOwogICAgICAgIHRoaXMuJHJlZnMuUm9vbUJhY2suUm9vbUJhY2tPcGVuKEJhY2tMaXN0KTsKICAgICAgfQogICAgfSwKICAgIHN0b3BDYXN0OiBmdW5jdGlvbiAoKSB7CiAgICAgIC8v5YWz5pKtCiAgICAgIHRoaXMuJFJDTGl2ZVJvb21MaWIubGVhdmVSb29tKHRoaXMuJGRhdGEucm9vbUlkKS50aGVuKCgpID0+IHsKICAgICAgICB0aGlzLiRSQ0xpdmVSb29tTGliLl9yb29taWRjbGkgPSAiIjsKICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCgicm9vbT9yb29tVHlwZT1saXZlUm9vbSIpOwogICAgICB9KTsKICAgIH0sCiAgICBtc2dPdXQ6IGZ1bmN0aW9uIChtc2cpIHsKICAgICAgLy/mnKzlnLDmtojmga8KICAgICAgY29uc29sZS5sb2cobXNnKTsKICAgICAgaWYgKG1zZy5yZXBsYWNlKC9ccyovZywgIiIpLmxlbmd0aCA9PSAwKSB7CiAgICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goInNob3dUb2FzdCIsIHsKICAgICAgICAgIHZhbHVlOiAi5raI5oGv5LiN6IO95Li656m6IiwKICAgICAgICB9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIC8v5Y+W5bGP6JS96K+N5YiX6KGoCiAgICAgIFJlcXVlc3QuZ2V0c2Vuc2l0aXZlTGlzdCh7CiAgICAgICAgcm9vbUlkOiB0aGlzLiRSQ0xpdmVSb29tTGliLl9yb29taWRjbGksCiAgICAgIH0pLnRoZW4oKHJlcykgPT4gewogICAgICAgIGxldCBzZW5kID0gdHJ1ZTsKICAgICAgICBjb25zb2xlLmxvZygi5bGP6JS96K+N5YiX6KGoIiwgcmVzKTsKICAgICAgICBpZiAocmVzLmRhdGEuY29kZSA9PSAxMDAwMCAmJiByZXMuZGF0YS5kYXRhKSB7CiAgICAgICAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgcmVzLmRhdGEuZGF0YS5sZW5ndGg7IGluZGV4KyspIHsKICAgICAgICAgICAgaWYgKG1zZy5pbmRleE9mKHJlcy5kYXRhLmRhdGFbaW5kZXhdWyJuYW1lIl0pICE9IC0xKSB7CiAgICAgICAgICAgICAgc2VuZCA9IGZhbHNlOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmICh0aGlzLiRSQ0xpdmVSb29tTGliLmltLl9yb29tU2hpZWxkcykgewogICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLiRSQ0xpdmVSb29tTGliLmltLl9yb29tU2hpZWxkcy5sZW5ndGg7IGorKykgewogICAgICAgICAgICBpZiAodGhpcy4kUkNMaXZlUm9vbUxpYi5pbS5fcm9vbVNoaWVsZHNbal0gPT0gbXNnKSB7CiAgICAgICAgICAgICAgc2VuZCA9IGZhbHNlOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGxldCB0eHRNc2cgPSB7CiAgICAgICAgICB1c2VyTmFtZTogdGhpcy4kc3RvcmUuc3RhdGUudXNlckluZm8udXNlck5hbWUsIC8vIOaWh+acrOWGheWuuQogICAgICAgICAgdXNlcklkOiB0aGlzLiRzdG9yZS5zdGF0ZS51c2VySW5mby51c2VySWQsCiAgICAgICAgICBjb250ZW50OiBtc2csCiAgICAgICAgfTsKICAgICAgICB0aGlzLiRSQ0xpdmVSb29tTGliLmVtaXQoIm9uTWVzc2FnZVJlY2VpdmVkIiwgewogICAgICAgICAgLy/lj5HmnKzlnLAKICAgICAgICAgIC8v5qih5ouf5pys5Zyw5raI5oGv5Y+R6YCBCiAgICAgICAgICBtZXNzYWdlVHlwZTogIlJDOkNoYXRyb29tOkJhcnJhZ2UiLAogICAgICAgICAgY29udGVudDogdHh0TXNnLAogICAgICAgIH0pOwogICAgICAgIGlmIChzZW5kKSB7CiAgICAgICAgICAvLyBjb25zb2xlLmxvZyh0eHRNc2cpOwogICAgICAgICAgdGhpcy4kUkNMaXZlUm9vbUxpYi5pbS5tZXNzYWdlVXBkYXRlKCJSQzpDaGF0cm9vbTpCYXJyYWdlIiwgdHh0TXNnKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIG5hbWVDbGljazogZnVuY3Rpb24gKGUpIHsKICAgICAgY29uc29sZS5sb2coZSwgImNsaWNrZWQiKTsKICAgIH0sCiAgICBvbkdpZnRNc2c6IGZ1bmN0aW9uICgpIHsKICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgdGhpcy5nZXRHaWZ0TGlzdCgpOwogICAgICB9LCAxMDAwKTsKICAgIH0sCiAgICAvL+ekvOeJqeabtOaWsAogICAgc2VuZEdpZnRTdWNjZXNzOiBhc3luYyBmdW5jdGlvbiAoKSB7CiAgICAgIC8vIGNvbnN0IGdpZnQgPSBhd2FpdCB0aGlzLmdldEdpZnRMaXN0KCk7CiAgICAgIC8vIGNvbnNvbGUubG9nKGdpZnQpOwogICAgICAvLyB0aGlzLnVwZGF0ZUFkbWluQW5kR2lmdChnaWZ0KTsKICAgIH0sCiAgICAvL+ekvOeJqeivt+axguiOt+WPluaVsOaNrgogICAgZ2V0R2lmdExpc3Q6IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIFJlcXVlc3QuZ2lmdExpc3QodGhpcy4kUkNMaXZlUm9vbUxpYi5fcm9vbWlkY2xpKS50aGVuKAogICAgICAgIGFzeW5jIChyZXMpID0+IHsKICAgICAgICAgIGxldCBHaWZ0T2JqID0ge307CiAgICAgICAgICBpZiAocmVzLmRhdGEuY29kZSA9PSAxMDAwMCAmJiByZXMuZGF0YS5kYXRhLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCByZXMuZGF0YS5kYXRhLmxlbmd0aDsgaSArPSAxKSB7CiAgICAgICAgICAgICAgaWYgKHJlcy5kYXRhLmRhdGFbaV1bdGhpcy4kZGF0YS51c2VySWRdKSB7CiAgICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5zdGF0ZS5naWZ0TnVtID0gTnVtYmVyKAogICAgICAgICAgICAgICAgICByZXMuZGF0YS5kYXRhW2ldW3RoaXMuJGRhdGEudXNlcklkXQogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgR2lmdE9iaiA9IHsKICAgICAgICAgICAgICAgIC4uLkdpZnRPYmosCiAgICAgICAgICAgICAgICAuLi5yZXMuZGF0YS5kYXRhW2ldLAogICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiB7IEdpZnRPYmo6IEdpZnRPYmogfTsKICAgICAgICB9CiAgICAgICk7CiAgICB9LAogICAgLy/ojrflj5bnrqHnkIblkZjmlbDmja4KICAgIGdldE1hbmFnZUxpc3Q6IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIFJlcXVlc3QubWFuYWdlTGlzdCh7CiAgICAgICAgcm9vbUlkOiB0aGlzLiRSQ0xpdmVSb29tTGliLl9yb29taWRjbGksCiAgICAgIH0pLnRoZW4oYXN5bmMgKHJlcykgPT4gewogICAgICAgIGxldCBNYW5hZ2VPYmogPSB7fTsKICAgICAgICBpZiAocmVzLmRhdGEuY29kZSA9PSAxMDAwMCAmJiByZXMuZGF0YS5kYXRhLmxlbmd0aCA+IDApIHsKICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmVzLmRhdGEuZGF0YS5sZW5ndGg7IGkgKz0gMSkgewogICAgICAgICAgICBNYW5hZ2VPYmpbcmVzLmRhdGEuZGF0YVtpXVsidXNlcklkIl1dID0gcmVzLmRhdGEuZGF0YVtpXTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIHsgTWFuYWdlT2JqOiBNYW5hZ2VPYmogfTsKICAgICAgICAvLyB0aGlzLiRuZXh0VGljaygoKSA9PiB7CiAgICAgICAgLy8gICB0aGlzLk1hbmFnZU9iaiA9IE1hbmFnZU9iajsKICAgICAgICAvLyB9KTsKICAgICAgfSk7CiAgICB9LAogICAgLy/ngrnlh7vpgIHljZXkurrnpLzniakKICAgIGdpZnRDbGljazogZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgY29uc29sZS5sb2coIml0ZW0iLCBpdGVtKTsKICAgICAgaWYgKAogICAgICAgIHRoaXMuJHN0b3JlLnN0YXRlLnJvb21JbmZvcm1hdGlvbi5jcmVhdGVVc2VyWyJ1c2VySWQiXSA9PSBpdGVtWyJ1c2VySWQiXQogICAgICApIHsKICAgICAgICBpdGVtWyJjcmVhdHVzZXIiXSA9IHRydWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaXRlbVsiY3JlYXR1c2VyIl0gPSBmYWxzZTsKICAgICAgfQogICAgICB0aGlzLiRkYXRhLnNob3dHaWZ0ID0gdHJ1ZTsKICAgICAgdGhpcy4kcmVmcy5naWZ0UGFuZWwuc2hvd0dpZnQoW2l0ZW1dKTsKICAgIH0sCiAgICAvL+W3sue7j+S4ium6pueahOinguS8l+S4i+m6pgogICAgcXVpdFNlYXQ6IGZ1bmN0aW9uICgpIHsKICAgICAgdGhpcy4kZGF0YS5xdWl0TWljID0gdHJ1ZTsKICAgICAgLy90aGlzLiRzdG9yZS5zdGF0ZS5vbk1pYyA9IGZhbHNlOwogICAgfSwKICAgIC8v5LiL6bqm5Yqo5L2cCiAgICBxaXV0TWljQWN0aW9uOiBmdW5jdGlvbiAoKSB7CiAgICAgIHRoaXMuJGRhdGEucXVpdE1pYyA9IGZhbHNlOwogICAgICB0aGlzLiRzdG9yZS5zdGF0ZS5vbk1pYyA9IGZhbHNlOwogICAgICB0aGlzLiRzdG9yZS5zdGF0ZS5vbkxpbmsgPSBmYWxzZTsKICAgICAgaWYgKEdldFF1ZXJ5U3RyaW5nKCJpc0FuY2hvciIpKSB7CiAgICAgICAgLy/mmK/miL/kuLvouKIx5Y+36bqm5L2NCiAgICAgICAgdGhpcy4kUkNMaXZlUm9vbUxpYi51cGRhdGVLZXlWYWx1ZSh7CiAgICAgICAgICBrZXk6ICJMSVZFX1ZJREVPX1NFQVRfSU5GT19QUkVfMSIsCiAgICAgICAgICB2YWx1ZTogSlNPTi5zdHJpbmdpZnkoewogICAgICAgICAgICB1c2VySWQ6ICIiLAogICAgICAgICAgICBtdXRlOiBmYWxzZSwKICAgICAgICAgICAgdXNlckVuYWJsZVZpZGVvOiB0cnVlLAogICAgICAgICAgICBmcmFtZToKICAgICAgICAgICAgICAie3swLjY4MzMwMDAwMDAwMDAwMDAyLCAwLjY5MDU5OTk5OTk5OTk5OTk5fSwgezAuMjk5OTk5OTk5OTk5OTk5OTksIDAuMTY4ODAwMDAwMDAwMDAwMDF9fSIsCiAgICAgICAgICAgIGxvY2s6IGZhbHNlLAogICAgICAgICAgICB1c2VyRW5hYmxlQXVkaW86IHRydWUsCiAgICAgICAgICAgIGluZGV4OiAxLAogICAgICAgICAgfSksCiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy4kUkNMaXZlUm9vbUxpYi5sZWF2ZVNlYXQoZmFsc2UsIGZhbHNlKTsKICAgICAgfQogICAgfSwKICAgIGJ0bkdpZnQ6IGZ1bmN0aW9uICgpIHsKICAgICAgdGhpcy4kZGF0YS5zaG93R2lmdCA9IHRydWU7CiAgICAgIGxldCB1c2VySW5zZWF0TGlzdCA9IFtdOwogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuJFJDTGl2ZVJvb21MaWIuc2VhdEluZm9MaXN0Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgY29uc29sZS5sb2codGhpcy4kUkNMaXZlUm9vbUxpYi5zZWF0SW5mb0xpc3RbaV0sIHRoaXMuJGRhdGEudXNlcmxpc3QpOwogICAgICAgIGlmICgKICAgICAgICAgIHRoaXMuJFJDTGl2ZVJvb21MaWIuc2VhdEluZm9MaXN0W2ldLnVzZXJJZCAmJgogICAgICAgICAgdGhpcy4kZGF0YS51c2VybGlzdFt0aGlzLiRSQ0xpdmVSb29tTGliLnNlYXRJbmZvTGlzdFtpXS51c2VySWRdCiAgICAgICAgKSB7CiAgICAgICAgICBpZiAoCiAgICAgICAgICAgIHRoaXMuJHN0b3JlLnN0YXRlLnJvb21JbmZvcm1hdGlvbi5jcmVhdGVVc2VyWyJ1c2VySWQiXSA9PQogICAgICAgICAgICB0aGlzLiRkYXRhLnVzZXJsaXN0W3RoaXMuJFJDTGl2ZVJvb21MaWIuc2VhdEluZm9MaXN0W2ldLnVzZXJJZF1bCiAgICAgICAgICAgICAgInVzZXJJZCIKICAgICAgICAgICAgXQogICAgICAgICAgKSB7CiAgICAgICAgICAgIHRoaXMuJGRhdGEudXNlcmxpc3RbdGhpcy4kUkNMaXZlUm9vbUxpYi5zZWF0SW5mb0xpc3RbaV0udXNlcklkXVsKICAgICAgICAgICAgICAiY3JlYXR1c2VyIgogICAgICAgICAgICBdID0gdHJ1ZTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRoaXMuJGRhdGEudXNlcmxpc3RbdGhpcy4kUkNMaXZlUm9vbUxpYi5zZWF0SW5mb0xpc3RbaV0udXNlcklkXVsKICAgICAgICAgICAgICAiY3JlYXR1c2VyIgogICAgICAgICAgICBdID0gZmFsc2U7CiAgICAgICAgICB9CiAgICAgICAgICB1c2VySW5zZWF0TGlzdC5wdXNoKAogICAgICAgICAgICB0aGlzLiRkYXRhLnVzZXJsaXN0W3RoaXMuJFJDTGl2ZVJvb21MaWIuc2VhdEluZm9MaXN0W2ldLnVzZXJJZF0KICAgICAgICAgICk7CiAgICAgICAgfQogICAgICB9CiAgICAgIGNvbnNvbGUubG9nKCJ1c2VySW5zZWF0TGlzdCIsIHVzZXJJbnNlYXRMaXN0KTsKICAgICAgdGhpcy4kcmVmcy5naWZ0UGFuZWwuc2hvd0dpZnQodXNlckluc2VhdExpc3QpOwogICAgfSwKICAgIGhpZGVHaWZ0OiBmdW5jdGlvbiAoKSB7CiAgICAgIGNvbnNvbGUubG9nKCJoaWQiKTsKICAgICAgdGhpcy4kZGF0YS5zaG93R2lmdCA9IGZhbHNlOwogICAgfSwKICAgIHN0YXJ0U2hvdzogZnVuY3Rpb24gKGUpIHsKICAgICAgY29uc29sZS5sb2coIuS4iuaKpSIsIGUpOwoKICAgICAgdGhpcy4kZGF0YS5yb29tSWQgPSBlLmRhdGEucm9vbUlkOwogICAgICB0aGlzLiRkYXRhLnJvb21OYW1lID0gdGhpcy4kc3RvcmUuc3RhdGUucm9vbVRpdGxlID0gZS5kYXRhLnJvb21OYW1lOwogICAgICB0aGlzLiRkYXRhLnVzZXJJZCA9IGUuZGF0YS5jcmVhdGVVc2VyLnVzZXJJZDsKICAgICAgdGhpcy4kZGF0YS51c2VyQXZhdGFyID0gZS5kYXRhLmNyZWF0ZVVzZXIucG9ydHJhaXQ7IC8v5Li75pKt5aS05YOPCiAgICAgIHRoaXMuJGRhdGEudXNlck5hbWUgPSBlLmRhdGEuY3JlYXRlVXNlci51c2VyTmFtZTsgLy/kuLvmkq3lkI0KICAgICAgdGhpcy4kZGF0YS5pc1ByaXZhdGUgPSBlLmRhdGEuaXNQcml2YXRlOyAvL+aYr+WQpuengeWvhgoKICAgICAgdGhpcy4kZGF0YS5zdGF0dXMgPSAyOyAvLyDmiL/pl7TliJ3lp4vljJbmiJDlip8KICAgICAgdGhpcy5jcmVhdGVSb29tKCk7CiAgICB9LAogICAgb25Sb29tQmFja0Nsb3NlOiBmdW5jdGlvbiAoKSB7fSwKICB9LAogIGNyZWF0ZWQoKSB7CiAgICBpZiAoR2V0UXVlcnlTdHJpbmcoImlzQW5jaG9yIikpIHsKICAgICAgdGhpcy4kZGF0YS5pc0FuY2hvciA9IHRydWU7CiAgICAgIHRoaXMuJGRhdGEuc3RhdHVzID0gMDsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuJGRhdGEuaXNBbmNob3IgPSBmYWxzZTsKICAgIH0KCiAgICBpZiAoR2V0UXVlcnlTdHJpbmcoInJvb21pZCIpKSB7CiAgICAgIC8vIHRoaXMuJGRhdGEucm9vbUlkID0gR2V0UXVlcnlTdHJpbmcoInJvb21pZCIpOwogICAgICBjb25zb2xlLmxvZygiaXNpbiByb29tIik7CiAgICAgIHRoaXMuJGRhdGEucm9vbUlkID0gR2V0UXVlcnlTdHJpbmcoInJvb21pZCIpOwogICAgfQogICAgdGhpcy4kUkNMaXZlUm9vbUxpYi5vbigicmVtb3RlVmlkZW9UcmFjayIsICh0cmFjaykgPT4gewogICAgICBjb25zb2xlLmxvZygicmN0IiwgdHJhY2suX3VzZXJJZCk7CiAgICAgIGlmICh0aGlzLiRkYXRhLnVzZXJJZCA9PSB0cmFjay5fdXNlcklkKSB7CiAgICAgICAgY29uc29sZS5sb2coIuiHquW3seeahOi/nOerr+a1gSIsIHRyYWNrKTsKICAgICAgICB0aGlzLiRyZWZzLnZpZGVvICYmIHRyYWNrLnBsYXkodGhpcy4kcmVmcy52aWRlbyk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29uc29sZS5sb2coIumdnuiHquW3sei/nOerr+a1gSIpOwogICAgICAgIHRoaXMuJHJlZnMudmlkZW9JblZpZGVvICYmIHRyYWNrLnBsYXkodGhpcy4kcmVmcy52aWRlb0luVmlkZW8pOwogICAgICB9CiAgICB9KTsKICAgIHRoaXMuJHN0b3JlLnN0YXRlLmdpZnROdW0gPSAwOyAvL+a4hembtuekvOeJqQogIH0sCiAgbW91bnRlZCgpIHsKICAgIGNvbnNvbGUubG9nKCJtb3RlZCIpOwogICAgaWYgKHRoaXMuJHN0b3JlLnN0YXRlLnVzZXJJbmZvLmltVG9rZW4gPT0gIiIpIHsKICAgICAgY29uc29sZS5sb2coIuacqueZu+W9leeKtuaAgei9rOWIsOeZu+W9lemhtemdoiIsIHRoaXMuJHN0b3JlLnN0YXRlLnVzZXJJbmZvLmltVG9rZW4pOwogICAgICB0aGlzLiRyb3V0ZXIucHVzaCgiL2xvZ2luIik7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICAvL+inhumikeiKgueCueS8oOWIsHNkawogICAgdGhpcy4kUkNMaXZlUm9vbUxpYi5ydGMuYm9keS52aWRlb05vZGUgPSB0aGlzLiRyZWZzLnZpZGVvOwogICAgdGhpcy4kUkNMaXZlUm9vbUxpYi5ydGMuYm9keS5taW5pTm9kZSA9IHRoaXMuJHJlZnMudmlkZW9JblZpZGVvOwogICAgLy/ogYrlpKnlrqTnu4Tlu7rkvKDliLBzdG9yZQogICAgdGhpcy4kc3RvcmUuc3RhdGUuQ2hhdHJvb20gPSB0aGlzLiRyZWZzLmNoYXRyb29tOwoKICAgIGlmICh0aGlzLiRkYXRhLmlzQW5jaG9yKSB7CiAgICAgIGNvbnNvbGUubG9nKCLkuLvmkq3ouqvku70iKTsKICAgIH0gZWxzZSB7CiAgICAgIGNvbnNvbGUubG9nKCLop4LkvJcg6Lqr5Lu9Iik7CiAgICAgIGlmICgKICAgICAgICB0aGlzLiRSQ0xpdmVSb29tTGliLl9yb29taWRjbGkgJiYKICAgICAgICB0aGlzLiRSQ0xpdmVSb29tTGliLl9yb29taWRjbGkgIT0gIiIKICAgICAgKSB7CiAgICAgICAgLy/lnKjmiL/pl7TlhoXjgIIKICAgICAgICBpZiAodGhpcy4kUkNMaXZlUm9vbUxpYi5fcm9vbWlkY2xpID09IEdldFF1ZXJ5U3RyaW5nKCJyb29taWQiKSkgewogICAgICAgICAgY29uc29sZS5sb2coIuWcqOWOn+aIv+mXtCIpOwogICAgICAgICAgdGhpcy4kUkNMaXZlUm9vbUxpYi5ydGMuYm9keS52aWRlb05vZGUgPSB0aGlzLiRyZWZzLnZpZGVvOwogICAgICAgICAgdGhpcy4kUkNMaXZlUm9vbUxpYi5ydGMuYm9keS5taW5pTm9kZSA9IHRoaXMuJHJlZnMudmlkZW9JblZpZGVvOwogICAgICAgICAgdGhpcy4kUkNMaXZlUm9vbUxpYi5nZXRFeGlzdCgpOwogICAgICAgICAgdGhpcy5pbml0KCk7IC8v5Yid5aeL5YyW5oi/6Ze05L+h5oGvCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCLmlrDmiL/pl7QiKTsKICAgICAgICAgIHRoaXMuJHN0b3JlLnN0YXRlLmN1cnJlbnRSb29tSWQgPSBHZXRRdWVyeVN0cmluZygicm9vbWlkIik7CiAgICAgICAgICB0aGlzLiRSQ0xpdmVSb29tTGliCiAgICAgICAgICAgIC5sZWF2ZVJvb20odGhpcy4kUkNMaXZlUm9vbUxpYi5fcm9vbWlkY2xpKQogICAgICAgICAgICAudGhlbigoKSA9PiB7CiAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICAgICB0aGlzLmpvaW5yb29tKCk7CiAgICAgICAgICAgICAgfSwgMTAwMCk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zb2xlLmxvZygi5rKh5pyJ5Yqg5YWl5oi/6Ze06KeC5LyX5Yqg5YWl5oi/6Ze0Iik7CiAgICAgICAgdGhpcy5qb2lucm9vbSgpOwogICAgICB9CiAgICB9CgogICAgY29uc29sZS5sb2coInRoaXMuJHN0b3JlLnN0YXRlLkNoYXRyb29tIiwgdGhpcy4kc3RvcmUuc3RhdGUuQ2hhdHJvb20pOwogICAgaWYgKHRoaXMuJGRhdGEuaXNBbmNob3IpIHsKICAgICAgdHJ5UHJldmlldyh0aGlzKTsKICAgIH0KICAgIGZ1bmN0aW9uIHRyeVByZXZpZXcodGFyZ2V0KSB7CiAgICAgIGlmICh0YXJnZXQuJFJDTGl2ZVJvb21MaWIgJiYgdGFyZ2V0LiRSQ0xpdmVSb29tTGliLnJ0Y3JlYWR5KSB7CiAgICAgICAgdGFyZ2V0LiRSQ0xpdmVSb29tTGliLnByZXZpZXcoewogICAgICAgICAgdmlkZW9Ob2RlOiB0YXJnZXQuJHJlZnMudmlkZW8sCiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICB0cnlQcmV2aWV3KHRhcmdldCk7CiAgICAgICAgfSwgMjApOwogICAgICB9CiAgICB9CiAgfSwKICBiZWZvcmVSb3V0ZUxlYXZlKHRvLCBmcm9tLCBuZXh0KSB7CiAgICBjb25zb2xlLmxvZygi6Lev55SxIiwgdGhpcy4kZGF0YS5pc0FuY2hvcik7CiAgICBpZiAodGhpcy4kZGF0YS5pc0FuY2hvcikgewogICAgICAvL+WmguaenOaYr+S4u+aSreebtOaOpemAgOWHuuaIv+mXtAogICAgICB0aGlzLiRSQ0xpdmVSb29tTGliLmxlYXZlUm9vbSh0aGlzLiRkYXRhLnJvb21JZCk7CiAgICAgIFJlcXVlc3QuZGVsZXRlUm9vbSh7IHJvb21JZDogdGhpcy4kZGF0YS5yb29tSWQgfSk7CiAgICAgIHRoaXMuJGRhdGEuaXNBbmNob3IgPSBmYWxzZTsKICAgIH0KICAgIHRoaXMuJHN0b3JlLnN0YXRlLmdpZnROdW0gPSAwOwogICAgdGhpcy4kc3RvcmUuc3RhdGUub25NaWMgPSBmYWxzZTsKICAgIHRoaXMuJHN0b3JlLnN0YXRlLm9uTGluayA9IGZhbHNlOwogICAgdGhpcy4kc3RvcmUuc3RhdGUuY3JlYXRVc2VyID0gZmFsc2U7CiAgICB0aGlzLiRzdG9yZS5zdGF0ZS5pc0ZyZWVFbnRlclNlYXQgPSBmYWxzZTsKICAgIHRoaXMuJGRhdGEuaXNBbmNob3IgPSBmYWxzZTsKICAgIG5leHQoKTsKICB9LAp9Owo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/pages/live","sourcesContent":["<template>\n  <div class=\"liveroom\">\n    <el-dialog title=\"提示\" :visible.sync=\"qiutConfirm\" width=\"80%\" center>\n      <span>确定结束本次直播吗？</span>\n      <span slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"qiutConfirm = false\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"stopCast\">确 定</el-button>\n      </span>\n    </el-dialog>\n    <roomBack ref=\"RoomBack\" @RoomBackClose=\"onRoomBackClose\" />\n    <RoomFit ref=\"RoomFit\" :RoomFitItemList=\"RoomFitItemList\" />\n    <Notice ref=\"Notice\" />\n    <UserList\n      ref=\"UserList\"\n      @onCloseUserList=\"onCloseUserList\"\n      @onClickUserList=\"onClickUserList\"\n    />\n    <ConnetWeat ref=\"ConnetWeat\" />\n    <div\n      class=\"quit\"\n      :class=\"{ menu: !isAnchor }\"\n      v-show=\"status == 2\"\n      @click=\"quitRoom()\"\n    ></div>\n    <video\n      class=\"videocontainer\"\n      :class=\"{ fliped: isAnchor }\"\n      width=\"100%\"\n      height=\"100%\"\n      ref=\"video\"\n    ></video>\n    <video\n      class=\"videoInVideo\"\n      :class=\"{\n        noshow:\n          this.$RCLiveRoomLib.seatInfoList[1] &&\n          this.$RCLiveRoomLib.seatInfoList[1].userId != '',\n      }\"\n      width=\"93px\"\n      height=\"166px\"\n      ref=\"videoInVideo\"\n      @click=\"minvideoClicked\"\n    ></video>\n    <liveCreate v-if=\"status == 0\" @startShow=\"startShow\" />\n    <liveTitle\n      :title=\"userName\"\n      :userAvatar=\"userAvatar\"\n      :isAnchor=\"isAnchor\"\n      :delay=\"delay\"\n      :giftNum=\"this.$store.state.giftNum\"\n      @clickNotice=\"clickNotice\"\n      v-if=\"status == 2\"\n    />\n\n    <liveAudience\n      v-if=\"status == 2\"\n      @audienceList=\"audienceList\"\n      :num=\"this.$store.state.roomUserList.length\"\n    />\n    <videoBox :status=\"0\" :size=\"50\" v-if=\"false\" />\n    <liveChat\n      ref=\"chatroom\"\n      v-show=\"status == 2\"\n      @nameClick=\"nameClick\"\n      @onGiftMsg=\"onGiftMsg\"\n      :top=\"50\"\n      :height=\"40\"\n    />\n    <!-- <roomUi /> -->\n    <liveQuitSeat\n      v-if=\"quitMic\"\n      @quit=\"qiutMicAction\"\n      @cancel=\"quitMic = false\"\n    >\n    </liveQuitSeat>\n    <CancelEvenSeat ref=\"CancelEvenSeat\" />\n    <UserCard />\n    <bottomBar\n      v-if=\"!showGift && status == 2\"\n      @msgOut=\"msgOut\"\n      @btnGift=\"btnGift\"\n      @ApplyWeatModel=\"ConnectMic\"\n      @ApplyWeat=\"ApplyWeat\"\n      @SetupModel=\"ConnectOperation\"\n      @quitSeat=\"quitSeat\"\n      ref=\"bottomBar\"\n    ></bottomBar>\n    <!-- <div class=\"input\">\n      <input class=\"inputer\" @keydown=\"keydown\" type=\"text\" v-model=\"msg\" />\n    </div> -->\n\n    <giftPanel\n      @hideGift=\"hideGift\"\n      @sendGiftSuccess=\"sendGiftSuccess\"\n      :isActive=\"showGift\"\n      :roomId=\"roomId\"\n      ref=\"giftPanel\"\n    ></giftPanel>\n  </div>\n</template>\n\n<script>\nimport liveTitle from \"../../components/baseUi/liveTitle.vue\";\nimport liveCreate from \"../../components/baseUi/liveCreate.vue\";\nimport liveChat from \"../../components/baseUi/liveChat.vue\";\nimport bottomBar from \"../../components/baseUi/bottomBar.vue\";\nimport giftPanel from \"../../components/baseUi/giftPanel.vue\";\nimport videoBox from \"../../components/baseUi/videoBox.vue\";\nimport liveAudience from \"../../components/baseUi/liveAudience.vue\";\nimport liveQuitSeat from \"../../components/baseUi/liveQuitSeat.vue\";\nimport CancelEvenSeat from \"../../components/room/CancelEvenSeat.vue\";\n\nimport roomBack from \"../../components/room/RoomBack.vue\";\nimport ConnetWeat from \"../../components/room/ConnetWeat.vue\";\nimport RoomFit from \"../../components/RoomFit.vue\";\nimport Notice from \"../../components/room/Notice.vue\";\nimport UserList from \"../../components/room/UserList.vue\";\nimport UserCard from \"../../components/baseUi/userCard.vue\";\n\nimport { GetQueryString } from \"../../utils/utils\";\nimport Request from \"../../request/index.js\";\nimport config from \"../../config\";\n\n// import CallRoom from \"./callRoom/index.vue\";\n// import PopupInput from \"../../components/PopupInput.vue\";\n\nexport default {\n  name: \"Roomlive\",\n  data: function () {\n    return {\n      // msg: \"ccc\",\n      videoNode: this.$refs.video,\n      miniNode: this.$refs.videoInVideo,\n      showGift: false,\n\n      isAnchor: false,\n      status: 2, // 0 主播开播 1 主播模式 2 观众模式\n      newroom: false, //是否新建房间\n      roomId: \"\", //本房间id\n      userAvatar: \"\", //主播头像\n      userName: \"\", //主播名字\n      roomName: \"\", //房间名字\n      delay: 0, //房间延迟\n      userId: \"\", //主播的id\n      giftNum: 0, //当前主播收到的礼物总量\n      isPrivate: \"\", //是否私密\n\n      seatInfoList: [], //麦位信息\n      userlist: {}, //进入过房间的用户列表\n      RoomFitItemList: [],\n      qiutConfirm: false, //主播退出确认\n      quitMic: false, //展示下麦界面\n      defaultAvatarUrl:\n        \"https://cdn.ronghub.com/demo/default/rce_default_avatar.png\",\n      defaultAddress: config.picPath,\n    };\n  },\n  components: {\n    liveCreate,\n    liveTitle,\n    videoBox,\n    liveChat,\n    bottomBar,\n    giftPanel,\n    liveAudience,\n    roomBack,\n    ConnetWeat,\n    RoomFit,\n    Notice,\n    liveQuitSeat,\n    CancelEvenSeat,\n    UserList,\n    UserCard,\n  },\n  methods: {\n    //创建房间\n    init: function () {\n      console.log(\"初始化房间 \");\n      this.$data.seatInfoList = this.$RCLiveRoomLib.seatInfoList; //更新麦位信息\n      this.getRoominformation();\n      this.getUserList();\n      this.$RCLiveRoomLib.on(\"RtcRtt\", (RtcRtt) => {\n        this.$data.delay = RtcRtt;\n      });\n    },\n    ConnectMic: function () {\n      this.$refs.ConnetWeat.openConnetWheat(false);\n    },\n    //打开公告\n    clickNotice: function () {\n      console.log(this.$RCLiveRoomLib);\n      this.$refs.Notice.setPopup({\n        isShow: false,\n        value: this.$RCLiveRoomLib.im._roomNotice\n          ? this.$RCLiveRoomLib.im._roomNotice\n          : \"欢迎来到 \" + this.$store.state.roomTitle,\n      });\n    },\n    onCloseUserList: function () {\n      console.log(\"onCloseUserList\");\n    },\n    onClickUserList: function () {\n      console.log(\"onClickUserList\");\n    },\n    minvideoClicked: function () {\n      if (\n        this.$RCLiveRoomLib.im.seatInfoList &&\n        this.$RCLiveRoomLib.im.seatInfoList[1] &&\n        this.$RCLiveRoomLib.im.seatInfoList[1].userId != \"\"\n      ) {\n        //1号麦位上有人\n        this.$data.quitMic = true;\n      }\n    },\n    audienceList: function () {\n      Request.roomuser({\n        roomId: this.$RCLiveRoomLib._roomidcli,\n      }).then((res) => {\n        console.log(res);\n        this.$store.dispatch(\"getRoomUserList\", res.data.data);\n      });\n      this.houseFilter = 5;\n      this.$refs.UserList.openUserList();\n    },\n    getRoominformation: function () {\n      Request.roominformation({ roomId: this.$RCLiveRoomLib._roomidcli })\n        .then((res) => {\n          if (res.data.code == 10000) {\n            this.$store.dispatch(\"getRoomInformation\", res.data.data);\n            this.$store.dispatch(\n              \"getroomBackground\",\n              res.data.data.backgroundUrl\n            );\n\n            this.$data.roomName = res.data.data.roomName;\n            this.$store.dispatch(\"getroomTitle\", res.data.data.roomName);\n            this.$store.dispatch(\"getroomPrivate\", {\n              isPrivate: res.data.data.isPrivate,\n              password: res.data.data.password,\n            });\n            this.$refs.chatroom.welcome();\n            this.$data.userlist[res.data.data.createUser.userId] =\n              res.data.data.createUser;\n\n            if (res.data.data.createUser.portrait) {\n              console.log(\"应用了头像\", this.$data.defaultAvatarUrl);\n              this.$data.userAvatar =\n                this.$data.defaultAddress + res.data.data.createUser.portrait;\n            } else {\n              console.log(\"应用了默认头像\", this.$data.defaultAvatarUrl);\n              this.$data.userAvatar = this.$data.defaultAvatarUrl;\n            }\n            this.$data.userName = res.data.data.createUser.userName;\n            this.$data.userId = res.data.data.createUser.userId;\n            if (\n              this.$store.state.userInfo.userId ==\n              res.data.data.createUser.userId\n            ) {\n              this.$store.state.creatUser = true;\n            }\n            console.log(\"state\", this.$store.state.userInfo.userId);\n          } else {\n            console.log(\"err\", res.data);\n          }\n        })\n        .catch((err) => {\n          console.log(err);\n        });\n    },\n    getUserList: function () {\n      Request.roomuser({\n        roomId: this.$RCLiveRoomLib._roomidcli,\n      }).then((res) => {\n        console.log(\"当前房间用户\", res);\n        this.$store.dispatch(\"getRoomUserList\", res.data.data);\n        for (var i = 0; i < res.data.data.length; i++) {\n          this.$data.userlist[res.data.data[i].userId] = res.data.data[i];\n        }\n        this.getGiftAndMan();\n      });\n    },\n    //获取gift和管理员\n    getGiftAndMan: function () {\n      console.log(\"getGiftAndMan called\");\n      Promise.all([this.getGiftList(), this.getManageList()])\n        .then((res) => {\n          console.log(res);\n          if (this.$RCLiveRoomLib.im.userId in res[1][\"ManageObj\"]) {\n            this.$store.dispatch(\"setRoomAdmin\", true);\n          } else {\n            this.$store.dispatch(\"setRoomAdmin\", false);\n          }\n          // // console.log(this.$store.state.roomUserList);\n          this.$nextTick(() => {\n            let Obj = {};\n            for (let i = 0; i < res.length; i += 1) {\n              Obj = {\n                ...Obj,\n                ...res[i],\n              };\n            }\n            this.GiftAndManageList = {\n              ...Obj,\n            };\n            this.$store.dispatch(\"getGiftAndManageList\", Obj);\n            // console.log(Obj);\n            this.SetSeatList(Obj);\n          });\n        })\n        .catch((err) => {\n          console.log(\"err\", err);\n        });\n    },\n    //设置座位List\n    SetSeatList: async function (resValue) {\n      console.log(\"GiftAndManageList:\", resValue);\n      this.houserMap = {};\n      let roomUserListMap = {};\n      this.itemList = [];\n\n      if (this.$store.state.roomUserList.length == 0) {\n        return;\n      }\n\n      console.log(this.$RCLiveRoomLib.seatInfoList);\n      if (!this.$RCLiveRoomLib.seatInfoList[0]) {\n        this.$RCLiveRoomLib.seatInfoList[0] = {\n          ...this.seatInfo,\n        };\n\n        // this.$RCLiveRoomLib.seatInfoList[0] = JSON.parse(\n        //   JSON.stringify(this.seatInfo)\n        // );\n        this.$RCLiveRoomLib.seatInfoList[0][\"status\"] = 1;\n        this.$RCLiveRoomLib.seatInfoList[0][\"userId\"] =\n          this.$store.state.roomInformation.createUser.userId;\n        // this.$RCLiveRoomLib.seatInfoList[0]['portrait']=this.$store.state.roomInformation.createUser.portrait\n      }\n      console.log(this.$RCLiveRoomLib.seatInfoList[0]);\n      for (let m = 0; m < this.$store.state.roomUserList.length; m += 1) {\n        roomUserListMap[this.$store.state.roomUserList[m][\"userId\"]] =\n          this.$store.state.roomUserList[m];\n      }\n\n      if (this.$RCLiveRoomLib.seatInfoList[0][\"mute\"] != !this.OwerMute) {\n        this.OwerMute = !this.$RCLiveRoomLib.seatInfoList[0][\"mute\"];\n      }\n\n      if (\n        this.$RCLiveRoomLib.seatInfoList[0][\"userId\"] &&\n        this.$RCLiveRoomLib.seatInfoList[0][\"userId\"] in roomUserListMap\n      ) {\n        this.houserMap = {\n          ...roomUserListMap[this.$RCLiveRoomLib.seatInfoList[0][\"userId\"]],\n        };\n      }\n\n      if (\n        this.$RCLiveRoomLib.seatInfoList[0][\"userId\"] &&\n        this.$RCLiveRoomLib.seatInfoList[0][\"userId\"] in resValue.GiftObj\n      ) {\n        this.houserMap = {\n          ...this.houserMap,\n          gift: resValue.GiftObj[this.$RCLiveRoomLib.seatInfoList[0][\"userId\"]],\n        };\n      }\n\n      this.houserMap = {\n        ...this.houserMap,\n        ...this.$RCLiveRoomLib.seatInfoList[0],\n      };\n\n      let arr = [];\n      // console.log(\n      //   \"this.$RCLiveRoomLib.roomInfo\",\n      //   this.$RCLiveRoomLib.roomInfo\n      // );\n      let seatCountNumber = 9;\n\n      for (let p = 1; p < seatCountNumber; p += 1) {\n        let OtherMap = {};\n        if (\n          this.$RCLiveRoomLib.seatInfoList[p] &&\n          this.$RCLiveRoomLib.seatInfoList[p][\"userId\"]\n        ) {\n          if (\n            this.$RCLiveRoomLib.seatInfoList[p][\"userId\"] in roomUserListMap\n          ) {\n            OtherMap = {\n              ...roomUserListMap[this.$RCLiveRoomLib.seatInfoList[p][\"userId\"]],\n            };\n          }\n\n          if (\n            this.$RCLiveRoomLib.seatInfoList[p][\"userId\"] in resValue.ManageObj\n          ) {\n            OtherMap = {\n              ...OtherMap,\n              isAdmin: true,\n            };\n          }\n\n          if (\n            this.$RCLiveRoomLib.seatInfoList[p][\"userId\"] in resValue.GiftObj\n          ) {\n            OtherMap = {\n              ...OtherMap,\n              gift: resValue.GiftObj[\n                this.$RCLiveRoomLib.seatInfoList[p][\"userId\"]\n              ],\n            };\n          }\n        }\n\n        if (this.$RCLiveRoomLib.seatInfoList[p]) {\n          arr.push({\n            ...OtherMap,\n            ...this.$RCLiveRoomLib.seatInfoList[p],\n            index: p,\n          });\n        } else {\n          this.$RCLiveRoomLib.seatInfoList[p] = {\n            ...this.seatInfo,\n          };\n          arr.push({\n            ...OtherMap,\n            ...this.seatInfo,\n            index: p,\n          });\n        }\n      }\n      for (let index = 0; index < arr.length; index += 1) {\n        if (this.$RCLiveRoomLib.im.userId == arr[index].userId) {\n          this.$store.dispatch(\"updateuserInseat\", true);\n          break;\n        }\n        if (index == arr.length - 1) {\n          this.$store.dispatch(\"updateuserInseat\", false);\n        }\n      }\n      this.itemList = arr;\n      this.$store.dispatch(\"updateItemList\", arr);\n\n      //  console.log(this.$RCLiveRoomLib.seatInfoList);\n      // console.log(\"OtherList\", arr);\n      // console.log(\"this.houserMap\", this.houserMap);\n    },\n    //房主设置状态控制\n    ConnectOperation: function () {\n      // console.log(this.$RCLiveRoomLib.roomInfo);\n      // const RoomFitList = JSON.parse(JSON.stringify(RoomFitItemList));\n      const RoomFitList = [\n        {\n          value: \"房间上锁\",\n          // eslint-disable-next-line no-undef\n          img: \"url(\" + require(\"../../assets/roomicon/LockRoon.png\") + \")\",\n        },\n        {\n          value: \"房间标题\",\n          // eslint-disable-next-line no-undef\n          img: \"url(\" + require(\"../../assets/roomicon/RoomTitle.png\") + \")\",\n        },\n        {\n          value: \"房间公告\",\n          // eslint-disable-next-line no-undef\n          img: \"url(\" + require(\"../../assets/roomicon/RoomNotice.png\") + \")\",\n        },\n        {\n          value: \"屏蔽词\",\n          img:\n            // eslint-disable-next-line no-undef\n            \"url(\" + require(\"../../assets/roomicon/ShieldingWords.png\") + \")\",\n        },\n      ];\n\n      // console.log(this.$store.state.roomPrivate);\n      if (this.$store.state.roomPrivate.isPrivate == 1) {\n        RoomFitList[0] = {\n          value: \"房间解锁\",\n          img:\n            // eslint-disable-next-line no-undef\n            \"url(\" + require(\"../../assets/roomicon/UnLockRoom.png\") + \")\",\n        };\n      }\n      console.log(\"构建：\", this.$store.state.isFreeEnterSeat);\n      if (this.$store.state.isFreeEnterSeat) {\n        RoomFitList.push({\n          value: \"申请上麦\",\n          img:\n            // eslint-disable-next-line no-undef\n            \"url(\" + require(\"../../assets/roomicon/BApplyWheat.png\") + \")\",\n        });\n      } else {\n        RoomFitList.push({\n          value: \"自由上麦\",\n          img:\n            // eslint-disable-next-line no-undef\n            \"url(\" + require(\"../../assets/roomicon/BFreeWheat.png\") + \")\",\n        });\n      }\n      this.RoomFitItemList = RoomFitList;\n      // console.log(this.RoomFitItemList);\n      this.$refs.RoomFit.openRoomFit();\n    },\n    //请求排麦与否\n    ApplyWeat: async function () {\n      if (this.$store.state.HasApply) {\n        this.$refs.CancelEvenSeat.CancelEvenSeatOpen();\n      } else {\n        if (this.$RCLiveRoomLib.im._FreeEnterSeat) {\n          //自由上麦的情况\n          if (\n            this.$RCLiveRoomLib.im.seatInfoList[1] &&\n            this.$RCLiveRoomLib.im.seatInfoList[1].userId &&\n            this.$RCLiveRoomLib.im.seatInfoList[1].userId.length\n          ) {\n            console.log(this.$RCLiveRoomLib.im.seatInfoList[1]);\n            this.$store.dispatch(\"showToast\", {\n              value: \"麦位已满\",\n            });\n          } else {\n            this.$RCLiveRoomLib.requestSeat();\n            //  this.$RCLiveRoomLib.enterSeat(1);\n            this.$store.state.onLink = true;\n            this.$store.state.onMic = true;\n            return;\n          }\n        } else {\n          await this.$RCLiveRoomLib.requestSeat();\n          this.$store.dispatch(\"showToast\", {\n            value: \"已申请连线，等待房主接受\",\n          });\n          setTimeout(() => {\n            this.$store.dispatch(\"userHasApply\", true);\n          }, 50);\n        }\n      }\n      // console.log(this.$store.state.HasApply);\n    },\n    getSeatInfolist: async function () {\n      const list = await this.$RCLiveRoomLib.getLatestSeatInfo();\n      console.log(list);\n    },\n    createRoom: function () {\n      console.log(\"crtRoom===\", this.$refs.video, this.$refs.videoInVideo);\n\n      console.log(\"当前用户：\", this.$store.state);\n      this.$RCLiveRoomLib\n        .createAndJoinRoom({\n          roomId: this.$data.roomId,\n          roomName: this.$data.roomName,\n          roomType: \"live\",\n          videoNode: this.$refs.video,\n          miniNode: this.$refs.videoInVideo,\n        })\n        .then(() => {\n          this.init();\n        });\n    },\n    joinroom: function () {\n      console.log(\"sdk加入房间动作\");\n      this.$RCLiveRoomLib\n        .joinRoom({\n          roomId: GetQueryString(\"roomid\"),\n          roomType: \"live\",\n          videoNode: this.$refs.video,\n          miniNode: this.$refs.videoInVideo,\n        })\n        .then(() => {\n          this.init();\n        });\n    },\n    quitRoom: function () {\n      if (this.$data.isAnchor) {\n        this.$data.qiutConfirm = true;\n      } else {\n        let BackList  =[];\n        if(this.$store.state.onMic){//在麦位上时不允许收起房间\n          BackList = [\n            {\n              value: \"离开房间\",\n              // eslint-disable-next-line no-undef\n              img: \"url(\" + require(\"../../assets/roomicon/CloseRoom.png\") + \")\",\n            }]\n        }else{\n          BackList = [\n            {\n              value: \"收起房间\",\n              // eslint-disable-next-line no-undef\n              img: \"url(\" + require(\"../../assets/roomicon/LeaveRoom.png\") + \")\",\n            },\n            {\n              value: \"离开房间\",\n              // eslint-disable-next-line no-undef\n              img: \"url(\" + require(\"../../assets/roomicon/CloseRoom.png\") + \")\",\n            },\n          ];\n        }\n        console.log(this.$refs.RoomBack.RoomBackOpen);\n        this.$refs.RoomBack.RoomBackOpen(BackList);\n      }\n    },\n    stopCast: function () {\n      //关播\n      this.$RCLiveRoomLib.leaveRoom(this.$data.roomId).then(() => {\n        this.$RCLiveRoomLib._roomidcli = \"\";\n        this.$router.push(\"room?roomType=liveRoom\");\n      });\n    },\n    msgOut: function (msg) {\n      //本地消息\n      console.log(msg);\n      if (msg.replace(/\\s*/g, \"\").length == 0) {\n        this.$store.dispatch(\"showToast\", {\n          value: \"消息不能为空\",\n        });\n        return;\n      }\n\n      //取屏蔽词列表\n      Request.getsensitiveList({\n        roomId: this.$RCLiveRoomLib._roomidcli,\n      }).then((res) => {\n        let send = true;\n        console.log(\"屏蔽词列表\", res);\n        if (res.data.code == 10000 && res.data.data) {\n          for (let index = 0; index < res.data.data.length; index++) {\n            if (msg.indexOf(res.data.data[index][\"name\"]) != -1) {\n              send = false;\n              break;\n            }\n          }\n        }\n        if (this.$RCLiveRoomLib.im._roomShields) {\n          for (let j = 0; j < this.$RCLiveRoomLib.im._roomShields.length; j++) {\n            if (this.$RCLiveRoomLib.im._roomShields[j] == msg) {\n              send = false;\n              break;\n            }\n          }\n        }\n        let txtMsg = {\n          userName: this.$store.state.userInfo.userName, // 文本内容\n          userId: this.$store.state.userInfo.userId,\n          content: msg,\n        };\n        this.$RCLiveRoomLib.emit(\"onMessageReceived\", {\n          //发本地\n          //模拟本地消息发送\n          messageType: \"RC:Chatroom:Barrage\",\n          content: txtMsg,\n        });\n        if (send) {\n          // console.log(txtMsg);\n          this.$RCLiveRoomLib.im.messageUpdate(\"RC:Chatroom:Barrage\", txtMsg);\n        }\n      });\n    },\n    nameClick: function (e) {\n      console.log(e, \"clicked\");\n    },\n    onGiftMsg: function () {\n      setTimeout(() => {\n        this.getGiftList();\n      }, 1000);\n    },\n    //礼物更新\n    sendGiftSuccess: async function () {\n      // const gift = await this.getGiftList();\n      // console.log(gift);\n      // this.updateAdminAndGift(gift);\n    },\n    //礼物请求获取数据\n    getGiftList: function () {\n      return Request.giftList(this.$RCLiveRoomLib._roomidcli).then(\n        async (res) => {\n          let GiftObj = {};\n          if (res.data.code == 10000 && res.data.data.length > 0) {\n            for (let i = 0; i < res.data.data.length; i += 1) {\n              if (res.data.data[i][this.$data.userId]) {\n                this.$store.state.giftNum = Number(\n                  res.data.data[i][this.$data.userId]\n                );\n              }\n              GiftObj = {\n                ...GiftObj,\n                ...res.data.data[i],\n              };\n            }\n          }\n          return { GiftObj: GiftObj };\n        }\n      );\n    },\n    //获取管理员数据\n    getManageList: function () {\n      return Request.manageList({\n        roomId: this.$RCLiveRoomLib._roomidcli,\n      }).then(async (res) => {\n        let ManageObj = {};\n        if (res.data.code == 10000 && res.data.data.length > 0) {\n          for (let i = 0; i < res.data.data.length; i += 1) {\n            ManageObj[res.data.data[i][\"userId\"]] = res.data.data[i];\n          }\n        }\n        return { ManageObj: ManageObj };\n        // this.$nextTick(() => {\n        //   this.ManageObj = ManageObj;\n        // });\n      });\n    },\n    //点击送单人礼物\n    giftClick: function (item) {\n      console.log(\"item\", item);\n      if (\n        this.$store.state.roomInformation.createUser[\"userId\"] == item[\"userId\"]\n      ) {\n        item[\"creatuser\"] = true;\n      } else {\n        item[\"creatuser\"] = false;\n      }\n      this.$data.showGift = true;\n      this.$refs.giftPanel.showGift([item]);\n    },\n    //已经上麦的观众下麦\n    quitSeat: function () {\n      this.$data.quitMic = true;\n      //this.$store.state.onMic = false;\n    },\n    //下麦动作\n    qiutMicAction: function () {\n      this.$data.quitMic = false;\n      this.$store.state.onMic = false;\n      this.$store.state.onLink = false;\n      if (GetQueryString(\"isAnchor\")) {\n        //是房主踢1号麦位\n        this.$RCLiveRoomLib.updateKeyValue({\n          key: \"LIVE_VIDEO_SEAT_INFO_PRE_1\",\n          value: JSON.stringify({\n            userId: \"\",\n            mute: false,\n            userEnableVideo: true,\n            frame:\n              \"{{0.68330000000000002, 0.69059999999999999}, {0.29999999999999999, 0.16880000000000001}}\",\n            lock: false,\n            userEnableAudio: true,\n            index: 1,\n          }),\n        });\n      } else {\n        this.$RCLiveRoomLib.leaveSeat(false, false);\n      }\n    },\n    btnGift: function () {\n      this.$data.showGift = true;\n      let userInseatList = [];\n      for (var i = 0; i < this.$RCLiveRoomLib.seatInfoList.length; i++) {\n        console.log(this.$RCLiveRoomLib.seatInfoList[i], this.$data.userlist);\n        if (\n          this.$RCLiveRoomLib.seatInfoList[i].userId &&\n          this.$data.userlist[this.$RCLiveRoomLib.seatInfoList[i].userId]\n        ) {\n          if (\n            this.$store.state.roomInformation.createUser[\"userId\"] ==\n            this.$data.userlist[this.$RCLiveRoomLib.seatInfoList[i].userId][\n              \"userId\"\n            ]\n          ) {\n            this.$data.userlist[this.$RCLiveRoomLib.seatInfoList[i].userId][\n              \"creatuser\"\n            ] = true;\n          } else {\n            this.$data.userlist[this.$RCLiveRoomLib.seatInfoList[i].userId][\n              \"creatuser\"\n            ] = false;\n          }\n          userInseatList.push(\n            this.$data.userlist[this.$RCLiveRoomLib.seatInfoList[i].userId]\n          );\n        }\n      }\n      console.log(\"userInseatList\", userInseatList);\n      this.$refs.giftPanel.showGift(userInseatList);\n    },\n    hideGift: function () {\n      console.log(\"hid\");\n      this.$data.showGift = false;\n    },\n    startShow: function (e) {\n      console.log(\"上报\", e);\n\n      this.$data.roomId = e.data.roomId;\n      this.$data.roomName = this.$store.state.roomTitle = e.data.roomName;\n      this.$data.userId = e.data.createUser.userId;\n      this.$data.userAvatar = e.data.createUser.portrait; //主播头像\n      this.$data.userName = e.data.createUser.userName; //主播名\n      this.$data.isPrivate = e.data.isPrivate; //是否私密\n\n      this.$data.status = 2; // 房间初始化成功\n      this.createRoom();\n    },\n    onRoomBackClose: function () {},\n  },\n  created() {\n    if (GetQueryString(\"isAnchor\")) {\n      this.$data.isAnchor = true;\n      this.$data.status = 0;\n    } else {\n      this.$data.isAnchor = false;\n    }\n\n    if (GetQueryString(\"roomid\")) {\n      // this.$data.roomId = GetQueryString(\"roomid\");\n      console.log(\"isin room\");\n      this.$data.roomId = GetQueryString(\"roomid\");\n    }\n    this.$RCLiveRoomLib.on(\"remoteVideoTrack\", (track) => {\n      console.log(\"rct\", track._userId);\n      if (this.$data.userId == track._userId) {\n        console.log(\"自己的远端流\", track);\n        this.$refs.video && track.play(this.$refs.video);\n      } else {\n        console.log(\"非自己远端流\");\n        this.$refs.videoInVideo && track.play(this.$refs.videoInVideo);\n      }\n    });\n    this.$store.state.giftNum = 0; //清零礼物\n  },\n  mounted() {\n    console.log(\"moted\");\n    if (this.$store.state.userInfo.imToken == \"\") {\n      console.log(\"未登录状态转到登录页面\", this.$store.state.userInfo.imToken);\n      this.$router.push(\"/login\");\n      return;\n    }\n\n    //视频节点传到sdk\n    this.$RCLiveRoomLib.rtc.body.videoNode = this.$refs.video;\n    this.$RCLiveRoomLib.rtc.body.miniNode = this.$refs.videoInVideo;\n    //聊天室组建传到store\n    this.$store.state.Chatroom = this.$refs.chatroom;\n\n    if (this.$data.isAnchor) {\n      console.log(\"主播身份\");\n    } else {\n      console.log(\"观众 身份\");\n      if (\n        this.$RCLiveRoomLib._roomidcli &&\n        this.$RCLiveRoomLib._roomidcli != \"\"\n      ) {\n        //在房间内。\n        if (this.$RCLiveRoomLib._roomidcli == GetQueryString(\"roomid\")) {\n          console.log(\"在原房间\");\n          this.$RCLiveRoomLib.rtc.body.videoNode = this.$refs.video;\n          this.$RCLiveRoomLib.rtc.body.miniNode = this.$refs.videoInVideo;\n          this.$RCLiveRoomLib.getExist();\n          this.init(); //初始化房间信息\n        } else {\n          console.log(\"新房间\");\n          this.$store.state.currentRoomId = GetQueryString(\"roomid\");\n          this.$RCLiveRoomLib\n            .leaveRoom(this.$RCLiveRoomLib._roomidcli)\n            .then(() => {\n              setTimeout(() => {\n                this.joinroom();\n              }, 1000);\n            });\n        }\n      } else {\n        console.log(\"没有加入房间观众加入房间\");\n        this.joinroom();\n      }\n    }\n\n    console.log(\"this.$store.state.Chatroom\", this.$store.state.Chatroom);\n    if (this.$data.isAnchor) {\n      tryPreview(this);\n    }\n    function tryPreview(target) {\n      if (target.$RCLiveRoomLib && target.$RCLiveRoomLib.rtcready) {\n        target.$RCLiveRoomLib.preview({\n          videoNode: target.$refs.video,\n        });\n      } else {\n        setTimeout(() => {\n          tryPreview(target);\n        }, 20);\n      }\n    }\n  },\n  beforeRouteLeave(to, from, next) {\n    console.log(\"路由\", this.$data.isAnchor);\n    if (this.$data.isAnchor) {\n      //如果是主播直接退出房间\n      this.$RCLiveRoomLib.leaveRoom(this.$data.roomId);\n      Request.deleteRoom({ roomId: this.$data.roomId });\n      this.$data.isAnchor = false;\n    }\n    this.$store.state.giftNum = 0;\n    this.$store.state.onMic = false;\n    this.$store.state.onLink = false;\n    this.$store.state.creatUser = false;\n    this.$store.state.isFreeEnterSeat = false;\n    this.$data.isAnchor = false;\n    next();\n  },\n};\n</script>\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\n<style scoped>\n@import url(\"./index.css\");\n</style>"]}]}