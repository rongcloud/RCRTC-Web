{"remainingRequest":"/Users/cuifengbo/work/RCRTC-Git/rcrtc-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/cuifengbo/work/RCRTC-Git/rcrtc-web/src/components/baseUi/liveChat.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/cuifengbo/work/RCRTC-Git/rcrtc-web/src/components/baseUi/liveChat.vue","mtime":1648104828593},{"path":"/Users/cuifengbo/work/RCRTC-Git/rcrtc-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/cuifengbo/work/RCRTC-Git/rcrtc-web/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/cuifengbo/work/RCRTC-Git/rcrtc-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/cuifengbo/work/RCRTC-Git/rcrtc-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmxldCBkYXJnU3RhdHVzID0gewogIGZyZWU6IDAsCiAgZGFyZ2luZzogMSwKfTsKCmxldCB0aGF0OwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogImNoYXRyb29tIiwKICBkYXRhOiBmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gewogICAgICBjaGF0TGlzdDogW10sCiAgICAgIHRpbWVDYW50cm9sOiB0cnVlLAogICAgfTsKICB9LAogIHByb3BzOiB7CiAgICB0b3A6IE51bWJlciwKICAgIGhlaWdodDogTnVtYmVyLAogIH0sCiAgY3JlYXRlZCgpIHsKICAgIHRoYXQgPSB0aGlzOwogIH0sCiAgdXBkYXRlZCgpIHsKICAgIHRoYXQuJHJlZnMuYm9keS5zdHlsZS50b3AgPQogICAgICB0aGF0LiRyZWZzLmNvbnRhaW5lci5vZmZzZXRIZWlnaHQgLSB0aGF0LiRyZWZzLmJvZHkub2Zmc2V0SGVpZ2h0ICsgInB4IjsKICB9LAogIG1vdW50ZWQoKSB7CiAgICAvLyBjb25zb2xlLmxvZyh0aGlzLiRzdG9yZS5zdGF0ZS5yb29tSW5mb3JtYXRpb24pOwogICAgaWYgKHRoaXMuJHN0b3JlLnN0YXRlLnJvb21JbmZvcm1hdGlvbi5yb29tVHlwZSAhPSAzKSB7CiAgICAgIC8v6Z2e55u05pKt5oi/6Ze055u05o6l5Y+R6YCB5qyi6L+OCiAgICAgIHRoaXMud2VsY29tZSgpOwogICAgfQoKICAgIGxldCBzdGF0dXMgPSBkYXJnU3RhdHVzLmZyZWU7CiAgICBsZXQgc3RhcnRZOwogICAgbGV0IG9yaWdpblk7CgogICAgZG9jdW1lbnQub25tb3VzZW1vdmUgPSBkYXJnSW5nOwogICAgdGhhdC4kcmVmcy5ib2R5Lm9ubW91c2Vkb3duID0gZGFyZ1N0YXJ0OwogICAgZG9jdW1lbnQub25tb3VzZXVwID0gZGFyZ0VuZDsKICAgIHRoYXQuJHJlZnMuYm9keS5vbm1vdXNlb3V0ID0gZGFyZ0VuZDsKCiAgICB0aGF0LiRyZWZzLmJvZHkub250b3VjaHN0YXJ0ID0gZGFyZ1N0YXJ0OwogICAgZG9jdW1lbnQub250b3VjaGVuZCA9IGRhcmdFbmQ7CiAgICBkb2N1bWVudC5vbnRvdWNobW92ZSA9IGRhcmdJbmc7CiAgICBsZXQgbyA9IHsKICAgICAgYm9keTogdGhhdC4kcmVmcy5ib2R5LAogICAgICBjb250YWluZXI6IHRoYXQuJHJlZnMuY29udGFpbmVyLAogICAgfTsKICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAvL+aUvuWIsOW8guatpemYn+WIl+mYsuayu+iOt+WPluWIsOeahOmrmOW6puS4jeWHhuehrgogICAgICBzZXR1cChvKTsKICAgIH0sIDApOwoKICAgIGZ1bmN0aW9uIHNldHVwKG9wdGlvbikgewogICAgICBpZiAodGhhdC4kcmVmcy5ib2R5KQogICAgICAgIHRoYXQuJHJlZnMuYm9keS5zdHlsZS50b3AgPQogICAgICAgICAgb3B0aW9uLmNvbnRhaW5lci5vZmZzZXRIZWlnaHQgLSBvcHRpb24uYm9keS5vZmZzZXRIZWlnaHQgKyAicHgiOwogICAgfQoKICAgIGZ1bmN0aW9uIGRhcmdTdGFydChlKSB7CiAgICAgIC8vIGNvbnNvbGUubG9nKGUudGFyZ2V0LmdldEF0dHJpYnV0ZSgib3dlciIpKTsKICAgICAgaWYgKGUudGFyZ2V0LmlkKSB7CiAgICAgICAgaWYgKHRoYXQudGltZUNhbnRyb2wpIHsKICAgICAgICAgIHRoYXQudGltZUNhbnRyb2wgPSBmYWxzZTsKICAgICAgICAgIHRoYXQuJGVtaXQoIm5hbWVDbGljayIsIHsKICAgICAgICAgICAgdXNlcklkOiBlLnRhcmdldC5pZCwKICAgICAgICAgIH0pOwogICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgIHRoYXQudGltZUNhbnRyb2wgPSB0cnVlOwogICAgICAgICAgfSwgNTAwKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKGUuY2hhbmdlZFRvdWNoZXMgJiYgZS5jaGFuZ2VkVG91Y2hlc1swXSkgewogICAgICAgIHN0YXJ0WSA9IGUuY2hhbmdlZFRvdWNoZXNbMF0uY2xpZW50WTsKICAgICAgfSBlbHNlIHsKICAgICAgICBzdGFydFkgPSBlLmNsaWVudFk7CiAgICAgIH0KCiAgICAgIHN0YXR1cyA9IGRhcmdTdGF0dXMuZGFyZ2luZzsKICAgICAgbGV0IHY7CiAgICAgIGlmICh0aGF0LiRyZWZzLmJvZHkuc3R5bGUudG9wKSB7CiAgICAgICAgdiA9IHRoYXQuJHJlZnMuYm9keS5zdHlsZS50b3Auc3Vic3RyKAogICAgICAgICAgMCwKICAgICAgICAgIHRoYXQuJHJlZnMuYm9keS5zdHlsZS50b3AubGVuZ3RoIC0gMgogICAgICAgICk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdiA9IDA7CiAgICAgIH0KICAgICAgb3JpZ2luWSA9IE51bWJlcih2KTsKICAgIH0KICAgIGZ1bmN0aW9uIGRhcmdFbmQoKSB7CiAgICAgIHN0YXR1cyA9IGRhcmdTdGF0dXMuZnJlZTsKICAgIH0KICAgIGZ1bmN0aW9uIGRhcmdJbmcoZSkgewogICAgICBsZXQgcnVubmluZ1k7CiAgICAgIGlmIChlLmNoYW5nZWRUb3VjaGVzICYmIGUuY2hhbmdlZFRvdWNoZXNbMF0pIHsKICAgICAgICBydW5uaW5nWSA9IGUuY2hhbmdlZFRvdWNoZXNbMF0uY2xpZW50WTsKICAgICAgfSBlbHNlIHsKICAgICAgICBydW5uaW5nWSA9IGUuY2xpZW50WTsKICAgICAgfQogICAgICBpZiAoc3RhdHVzID09IGRhcmdTdGF0dXMuZGFyZ2luZykgewogICAgICAgIGxldCB0OwogICAgICAgIHQgPSBOdW1iZXIocnVubmluZ1kgLSBzdGFydFkgKyBvcmlnaW5ZKTsKCiAgICAgICAgaWYgKAogICAgICAgICAgdCA8IDAgJiYKICAgICAgICAgIHQgPiB0aGF0LiRyZWZzLmNvbnRhaW5lci5vZmZzZXRIZWlnaHQgLSB0aGF0LiRyZWZzLmJvZHkub2Zmc2V0SGVpZ2h0CiAgICAgICAgKSB7CiAgICAgICAgICB0aGF0LiRyZWZzLmJvZHkuc3R5bGUudG9wID0gdCArICJweCI7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICBja2Q6IGZ1bmN0aW9uICgpIHsKICAgICAgLy8gICBjb25zb2xlLmxvZygiY2tkIiwgdGhpcyk7CiAgICB9LAogICAgcHVzaDogZnVuY3Rpb24gKG1lc3NhZ2UpIHsKICAgICAgLy8gY29uc29sZS5sb2cobWVzc2FnZSk7CiAgICAgIHRoaXMuX2RhdGEuY2hhdExpc3QucHVzaChtZXNzYWdlKTsKICAgIH0sCiAgICBkb3duOiBmdW5jdGlvbiAoKSB7CiAgICAgIC8vICBjb25zb2xlLmxvZygiZG93biIpOwogICAgfSwKICAgIHVwOiBmdW5jdGlvbiAoKSB7CiAgICAgIC8vICBjb25zb2xlLmxvZygidXAiKTsKICAgIH0sCiAgICBtb3ZlOiBmdW5jdGlvbiAoKSB7CiAgICAgIC8vIGNvbnNvbGUubG9nKCJtb3ZlIik7CiAgICB9LAogICAgZ2lmdDogZnVuY3Rpb24gKCkgewogICAgICB0aGlzLiRlbWl0KCJvbkdpZnRNc2ciKTsKICAgIH0sCiAgICB3ZWxjb21lOiBmdW5jdGlvbiAoKSB7CiAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsKICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgIGxldCByb29tdHlwZSA9ICLono3kupEgUlRDIOivreiBiuaIvyI7CiAgICAgICAgICBpZiAodGhpcy4kc3RvcmUuc3RhdGUucm9vbUluZm9ybWF0aW9uLnJvb21UeXBlID09IDMpIHsKICAgICAgICAgICAgcm9vbXR5cGUgPSAi6J6N5LqRIFJUQyDnm7Tmkq3pl7QiOwogICAgICAgICAgfQogICAgICAgICAgdGhpcy5jaGF0TGlzdCA9IFsKICAgICAgICAgICAgIjxzcGFuIHN0eWxlPSdjb2xvcjpyZ2JhKDEwNiwgMTU5LCAyNTUsIDEpOyc+IOasoui/juadpeWIsCAgIiArCiAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuc3RhdGUucm9vbUluZm9ybWF0aW9uLnJvb21OYW1lICsKICAgICAgICAgICAgICAiIDwvc3Bhbj4iLAogICAgICAgICAgICAiPHNwYW4gc3R5bGU9J2NvbG9yOnJnYmEoMTA2LCAxNTksIDI1NSwgMSknPiDmhJ/osKLkvb/nlKgiICsKICAgICAgICAgICAgICByb29tdHlwZSArCiAgICAgICAgICAgICAgIu+8jOivt+mBteWuiOebuOWFs+azleinhO+8jOS4jeimgeS8oOaSreS9juS/l+OAgeaatOWKm+etieS4jeiJr+S/oeaBr+OAguasoui/juaCqOaKiuS9v+eUqOi/h+eoi+S4reeahOaEn+WPl+WPjemmiOe7meaIkeS7rOOAgjwvc3Bhbj4iLAogICAgICAgICAgXTsKICAgICAgICB9LCAxMDApOwogICAgICB9KTsKICAgIH0sCiAgfSwKfTsK"},{"version":3,"sources":["liveChat.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;AAoBA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"liveChat.vue","sourceRoot":"src/components/baseUi","sourcesContent":["<template>\n  <div\n    ref=\"container\"\n    class=\"mainContainer\"\n    :style=\"{ top: top + '%', height: height + '%' }\"\n    @mousedown=\"down()\"\n    @mouseup=\"up()\"\n    @mousemove=\"move()\"\n  >\n    <div class=\"bodyContainer\" ref=\"body\">\n      <div\n        class=\"chatItems\"\n        v-for=\"(item, i) in chatList\"\n        :key=\"i\"\n        v-html=\"item\"\n      ></div>\n    </div>\n  </div>\n</template>\n<script>\nlet dargStatus = {\n  free: 0,\n  darging: 1,\n};\n\nlet that;\nexport default {\n  name: \"chatroom\",\n  data: function () {\n    return {\n      chatList: [],\n      timeCantrol: true,\n    };\n  },\n  props: {\n    top: Number,\n    height: Number,\n  },\n  created() {\n    that = this;\n  },\n  updated() {\n    that.$refs.body.style.top =\n      that.$refs.container.offsetHeight - that.$refs.body.offsetHeight + \"px\";\n  },\n  mounted() {\n    // console.log(this.$store.state.roomInformation);\n    if (this.$store.state.roomInformation.roomType != 3) {\n      //非直播房间直接发送欢迎\n      this.welcome();\n    }\n\n    let status = dargStatus.free;\n    let startY;\n    let originY;\n\n    document.onmousemove = dargIng;\n    that.$refs.body.onmousedown = dargStart;\n    document.onmouseup = dargEnd;\n    that.$refs.body.onmouseout = dargEnd;\n\n    that.$refs.body.ontouchstart = dargStart;\n    document.ontouchend = dargEnd;\n    document.ontouchmove = dargIng;\n    let o = {\n      body: that.$refs.body,\n      container: that.$refs.container,\n    };\n    setTimeout(() => {\n      //放到异步队列防治获取到的高度不准确\n      setup(o);\n    }, 0);\n\n    function setup(option) {\n      if (that.$refs.body)\n        that.$refs.body.style.top =\n          option.container.offsetHeight - option.body.offsetHeight + \"px\";\n    }\n\n    function dargStart(e) {\n      // console.log(e.target.getAttribute(\"ower\"));\n      if (e.target.id) {\n        if (that.timeCantrol) {\n          that.timeCantrol = false;\n          that.$emit(\"nameClick\", {\n            userId: e.target.id,\n          });\n          setTimeout(() => {\n            that.timeCantrol = true;\n          }, 500);\n        }\n      }\n      if (e.changedTouches && e.changedTouches[0]) {\n        startY = e.changedTouches[0].clientY;\n      } else {\n        startY = e.clientY;\n      }\n\n      status = dargStatus.darging;\n      let v;\n      if (that.$refs.body.style.top) {\n        v = that.$refs.body.style.top.substr(\n          0,\n          that.$refs.body.style.top.length - 2\n        );\n      } else {\n        v = 0;\n      }\n      originY = Number(v);\n    }\n    function dargEnd() {\n      status = dargStatus.free;\n    }\n    function dargIng(e) {\n      let runningY;\n      if (e.changedTouches && e.changedTouches[0]) {\n        runningY = e.changedTouches[0].clientY;\n      } else {\n        runningY = e.clientY;\n      }\n      if (status == dargStatus.darging) {\n        let t;\n        t = Number(runningY - startY + originY);\n\n        if (\n          t < 0 &&\n          t > that.$refs.container.offsetHeight - that.$refs.body.offsetHeight\n        ) {\n          that.$refs.body.style.top = t + \"px\";\n        }\n      }\n    }\n  },\n  methods: {\n    ckd: function () {\n      //   console.log(\"ckd\", this);\n    },\n    push: function (message) {\n      // console.log(message);\n      this._data.chatList.push(message);\n    },\n    down: function () {\n      //  console.log(\"down\");\n    },\n    up: function () {\n      //  console.log(\"up\");\n    },\n    move: function () {\n      // console.log(\"move\");\n    },\n    gift: function () {\n      this.$emit(\"onGiftMsg\");\n    },\n    welcome: function () {\n      this.$nextTick(() => {\n        setTimeout(() => {\n          let roomtype = \"融云 RTC 语聊房\";\n          if (this.$store.state.roomInformation.roomType == 3) {\n            roomtype = \"融云 RTC 直播间\";\n          }\n          this.chatList = [\n            \"<span style='color:rgba(106, 159, 255, 1);'> 欢迎来到  \" +\n              this.$store.state.roomInformation.roomName +\n              \" </span>\",\n            \"<span style='color:rgba(106, 159, 255, 1)'> 感谢使用\" +\n              roomtype +\n              \"，请遵守相关法规，不要传播低俗、暴力等不良信息。欢迎您把使用过程中的感受反馈给我们。</span>\",\n          ];\n        }, 100);\n      });\n    },\n  },\n};\n</script>\n<style scoped>\n.mainContainer {\n  position: absolute;\n  top: 50%;\n  left: 0px;\n  width: 80%;\n  height: 40%;\n  color: #fff;\n  text-align: left;\n  overflow: hidden;\n}\n.bodyContainer {\n  position: absolute;\n}\n.chatItems {\n  width: fit-content;\n  font-size: 14px;\n  padding: 12px;\n  margin: 12px;\n  background: rgba(0, 0, 0, 0.3);\n  border-radius: 1px 6px 6px 6px;\n  word-break: break-all;\n}\n.voiceIcon {\n  width: 20px;\n  height: 20px;\n  background: url(\"../../assets/live/icon-miniwave.png\") no-repeat;\n  background-size: 18px 18px;\n}\n</style>"]}]}